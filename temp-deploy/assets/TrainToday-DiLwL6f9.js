import{r as l,j as e,T as F,a1 as G,A as H,l as K,$ as q,a2 as z}from"./ui-vendor-BLoy3R85.js";import{g as J,a as D}from"./persistCycle-BAAp1NU7.js";import{e as Q,g as U,l as v,a as T,b as V}from"./pr-CoDTDLSf.js";import{o as X}from"./index-Dz8bHEFc.js";import{u as Y,L as Z}from"./router-vendor-CDc5MEim.js";import"./react-vendor-DoC2WAmd.js";import"./data-vendor-CWegSrCC.js";import"./chart-vendor-DbvXzfx8.js";function y({title:m,children:a}){return e.jsxs("div",{className:"bg-gray-900/60 border border-gray-700 rounded px-4 py-3",children:[e.jsx("div",{className:"text-white font-medium mb-2",children:m}),a]})}function _({idx:m,set:a,onChange:i}){const s=!!a.amrap,[u,j]=l.useState(a.reps??(s?"":a.targetReps??a.minReps??"")),[p,o]=l.useState(!1);return l.useEffect(()=>{i({idx:m,reps:u===""?null:Number(u),done:p,weight:a.weight,amrap:s,percent:a.percent})},[u,p]),e.jsxs("div",{className:"flex items-center justify-between gap-3 py-1",children:[e.jsxs("div",{className:"text-gray-300 text-sm",children:[e.jsxs("span",{className:"text-gray-400 mr-2",children:["Set ",m+1,":"]}),e.jsxs("span",{className:"font-mono",children:[a.weight," lb"]}),a.percent!=null&&e.jsxs("span",{className:"text-gray-500",children:[" (",a.percent,"%)"]})," · ",s?e.jsx("span",{className:"text-red-300 font-semibold",children:"AMRAP"}):e.jsxs("span",{children:[a.reps??a.targetReps??a.minReps," reps"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"w-16 bg-gray-800 border border-gray-700 rounded px-2 py-1 text-gray-100 text-sm",placeholder:s?"reps":"done",value:u,onChange:h=>j(h.target.value.replace(/[^\d]/g,""))}),e.jsxs("label",{className:"flex items-center gap-1 text-sm text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:p,onChange:h=>o(h.target.checked)}),"Done"]})]})]})}function ce(){var C,M,A;const m=Y(),{show:a}=X(),{active:i,today:s,weekObj:u}=l.useMemo(()=>J(),[]),[j,p]=l.useState(()=>((s==null?void 0:s.warmups)||[]).map(()=>!1)),[o,h]=l.useState(()=>((s==null?void 0:s.mainSets)||[]).map(()=>({reps:null,done:!1}))),[N,P]=l.useState(()=>((s==null?void 0:s.assistance)||[]).map(()=>!1)),[w,W]=l.useState(""),[L,$]=l.useState(!1);if(l.useEffect(()=>{var t;!i||!s||o.length!==(((t=s.mainSets)==null?void 0:t.length)||0)&&h((s.mainSets||[]).map(()=>({reps:null,done:!1})))},[i,s]),!i||!s)return e.jsxs("div",{className:"max-w-3xl mx-auto p-4 space-y-4",children:[e.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-700 rounded p-4 flex items-start gap-3",children:[e.jsx(F,{className:"w-5 h-5 text-yellow-400 mt-0.5"}),e.jsxs("div",{className:"text-yellow-100 text-sm",children:[e.jsx("div",{className:"font-semibold mb-1",children:"No active 5/3/1 cycle found."}),e.jsxs("p",{children:["Go to the 5/3/1 Program Builder and press ",e.jsx("b",{children:"Start Cycle"}),"."]})]})]}),e.jsxs("button",{onClick:()=>m("/program"),className:"inline-flex items-center gap-2 px-3 py-2 rounded bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(G,{className:"w-4 h-4"})," Open Program Builder"]})]});const S=(((C=s.mainSets)==null?void 0:C.length)||0)-1,f=(M=s.mainSets)==null?void 0:M[S],k=((A=o==null?void 0:o[S])==null?void 0:A.reps)||0,R=Q((f==null?void 0:f.weight)||0,k),E=()=>p((s.warmups||[]).map(()=>!0)),I=t=>{h(r=>{const n=[...r];return n[t.idx]={reps:t.reps,done:t.done,weight:t.weight,amrap:t.amrap,percent:t.percent},n})},B=()=>{const t={id:`531-${Date.now()}`,when:new Date().toISOString(),week:i.currentWeek,dayIndex:i.currentDayIndex,day:s.day,lift:s.lift,liftLabel:s.liftLabel,tm:s.tm,warmups:(s.warmups||[]).map((c,d)=>({...c,done:!!j[d]})),mainSets:(s.mainSets||[]).map((c,d)=>{var b,g;return{...c,loggedReps:((b=o[d])==null?void 0:b.reps)??null,done:!!((g=o[d])!=null&&g.done)}}),assistance:(s.assistance||[]).map((c,d)=>({...c,done:!!N[d]})),notes:w,e1RM:R},r=U().filter(c=>v(c)===v(t)),n=T(t),x=n?(()=>{const c=r.reduce((d,b)=>{const g=T(b);return Math.max(d,(g==null?void 0:g.e1RM)||0)},0);return(n.e1RM||0)>c})():!1;V(t),D(),$(!0),x?a(`PR! ${v(t)} e1RM ${n.e1RM} — ${n.weight}×${n.reps}`,{kind:"success",ttl:4500}):a("Session saved.",{kind:"info",ttl:2e3}),setTimeout(()=>m("/"),600)},O=()=>{D(),m(0)};return e.jsxs("div",{className:"max-w-4xl mx-auto p-4 space-y-5",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl text-white font-semibold flex items-center gap-2",children:[e.jsx(H,{className:"w-6 h-6 text-red-400"})," Train Today"]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Week ",i.currentWeek," • Day ",i.currentDayIndex+1," • ",e.jsx("b",{children:s.day})," • ",s.liftLabel]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{to:"/print-week",className:"px-3 py-1.5 rounded border border-gray-600 text-gray-100 hover:bg-gray-800 text-sm",children:"Print Week"}),L&&e.jsxs("div",{className:"bg-green-900/20 border border-green-600 text-green-200 text-sm px-3 py-2 rounded inline-flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"})," Session saved"]})]})]}),e.jsx(y,{title:"Training Max Recap",children:e.jsxs("div",{className:"text-sm text-gray-300",children:[s.liftLabel,": ",e.jsxs("span",{className:"font-mono",children:[s.tm||0," lb"]})]})}),e.jsx(y,{title:"Warm-up Sets (40/50/60%)",children:(s.warmups||[]).length===0?e.jsx("div",{className:"text-gray-400 text-sm",children:"No warm-ups found."}):e.jsxs("div",{className:"space-y-2",children:[(s.warmups||[]).map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"text-gray-300",children:[e.jsxs("span",{className:"text-gray-400 mr-2",children:["Set ",r+1,":"]}),e.jsxs("span",{className:"font-mono",children:[t.weight," lb"]}),t.percent!=null&&e.jsxs("span",{className:"text-gray-500",children:[" (",t.percent,"%)"]})," · ",e.jsxs("span",{children:[t.reps??5," reps"]})]}),e.jsxs("label",{className:"flex items-center gap-1 text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:!!j[r],onChange:n=>{const x=[...j];x[r]=n.target.checked,p(x)}}),"Done"]})]},r)),e.jsx("button",{onClick:E,className:"mt-2 inline-flex items-center gap-2 px-3 py-1.5 rounded border border-gray-600 text-gray-100 hover:bg-gray-800 text-xs",children:"Mark All Done"})]})}),e.jsx(y,{title:"Main Sets",children:(s.mainSets||[]).length===0?e.jsx("div",{className:"text-gray-400 text-sm",children:"No main sets found."}):e.jsxs("div",{className:"space-y-2",children:[(s.mainSets||[]).map((t,r)=>e.jsx(_,{idx:r,set:t,onChange:I},r)),e.jsxs("div",{className:"mt-2 text-xs text-gray-400",children:["Last set is AMRAP in Weeks 1–3. Stop 1 rep shy of failure; keep form tight.",f&&e.jsxs("div",{className:"mt-1",children:["e1RM from AMRAP (",f.weight," lb × ",k||0,"):"," ",e.jsxs("span",{className:"text-gray-200 font-mono",children:[R||0," lb"]})]})]})]})}),e.jsx(y,{title:"Assistance",children:(s.assistance||[]).length===0?e.jsx("div",{className:"text-gray-400 text-sm",children:"No assistance selected for this lift."}):e.jsx("div",{className:"space-y-2",children:(s.assistance||[]).map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"text-gray-300",children:[t.name||t.title||"Assistance"," ",t.sets&&t.reps&&e.jsxs("span",{className:"text-gray-500",children:["(",t.sets,"×",t.reps,")"]})]}),e.jsxs("label",{className:"flex items-center gap-1 text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:!!N[r],onChange:n=>{const x=[...N];x[r]=n.target.checked,P(x)}}),"Done"]})]},r))})}),e.jsx(y,{title:"Notes",children:e.jsx("textarea",{className:"w-full min-h-[90px] bg-gray-800 border border-gray-700 rounded p-2 text-gray-100 text-sm",placeholder:"Cues, pain, bar speed, etc.",value:w,onChange:t=>W(t.target.value)})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:B,className:"inline-flex items-center gap-2 px-4 py-2 rounded bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(q,{className:"w-4 h-4"})," Complete Session"]}),e.jsxs("button",{onClick:O,className:"inline-flex items-center gap-2 px-4 py-2 rounded border border-gray-600 text-gray-100 hover:bg-gray-800",children:[e.jsx(z,{className:"w-4 h-4"})," Skip Day"]})]})]})}export{ce as default};
//# sourceMappingURL=TrainToday-DiLwL6f9.js.map
