import{j as s,r as q}from"./ui-vendor-BLoy3R85.js";import{u as F}from"./index-BJgVdXSK.js";import{u as L}from"./router-vendor-CDc5MEim.js";import"./react-vendor-DoC2WAmd.js";import"./data-vendor-CWegSrCC.js";import"./chart-vendor-DbvXzfx8.js";const I="ph_active_plan_v1";function E(e,r={upper:5,lower:10}){var l,o;if(!(e!=null&&e.tm_by_lift)||!(e!=null&&e.days))throw new Error("Invalid review state — missing TMs or days.");const n={id:((o=(l=globalThis==null?void 0:globalThis.crypto)==null?void 0:l.randomUUID)==null?void 0:o.call(l))??String(Date.now()),createdAt:new Date().toISOString(),cycle:1,reviewState:e,nextCycleIncrements:r};try{localStorage.setItem(I,JSON.stringify(n))}catch(m){console.warn("Failed to persist active plan",m)}return n}function $(e,r,n){const l=e/r;return n==="up"?Math.ceil(l)*r:n==="down"?Math.floor(l)*r:Math.round(l)*r}function O(e,r,n,l){return $(e*r,n,l)}const W={press:"Overhead Press",bench:"Bench Press",squat:"Back Squat",deadlift:"Deadlift"};function K(){var a,j,_,w,x,T,k,C,R,P,S,B,D;const{state:e}=F(),r={press:Number((j=(a=e==null?void 0:e.lifts)==null?void 0:a.press)==null?void 0:j.tm)||0,bench:Number((w=(_=e==null?void 0:e.lifts)==null?void 0:_.bench)==null?void 0:w.tm)||0,squat:Number((T=(x=e==null?void 0:e.lifts)==null?void 0:x.squat)==null?void 0:T.tm)||0,deadlift:Number((C=(k=e==null?void 0:e.lifts)==null?void 0:k.deadlift)==null?void 0:C.tm)||0},n=(e==null?void 0:e.loadingOption)===2||((R=e==null?void 0:e.loading)==null?void 0:R.option)===2?"opt2":"opt1",l={ceil:"up",floor:"down",nearest:"nearest"},o=(e==null?void 0:e.units)==="kg"?"kg":"lb",m=l[e==null?void 0:e.rounding]||"nearest",g={weekly_option:n,amrap_last_set:!0,warmup_preset:"standard_40_50_60",units:o,rounding:{mode:m,step:o==="kg"?2.5:5},deadlift_rep_style:(e==null?void 0:e.deadliftRepStyle)==="touch_and_go"?"touch_and_go":"dead_stop",schedule:((P=e==null?void 0:e.schedule)==null?void 0:P.frequency)===3?"3_day":((S=e==null?void 0:e.schedule)==null?void 0:S.frequency)===2?"2_day":((B=e==null?void 0:e.schedule)==null?void 0:B.frequency)===1?"1_day":"4_day",progression:{upper_inc:5,lower_inc:10},template:(e==null?void 0:e.templateKey)==="bbb50"||(e==null?void 0:e.templateKey)==="bbb60"||((D=e==null?void 0:e.supplemental)==null?void 0:D.strategy)==="bbb"?"bbb":(e==null?void 0:e.templateKey)||"triumvirate"},c=n==="opt2"?[[.75,.8,.85],[.8,.85,.9],[.85,.9,.95],[.4,.5,.6]]:[[.65,.75,.85],[.7,.8,.9],[.75,.85,.95],[.4,.5,.6]],p=[["5","5","5+"],["3","3","3+"],["5","3","1+"],["5","5","5"]];function N(){function b(M){return{sets:c[M].map((v,f)=>({set:f+1,pct_of_tm:v,reps:p[M][f],amrap:M<3&&f===2,load_rounded:0}))}}return{w1:b(0),w2:b(1),w3:b(2),w4_deload:b(3)}}function u(b,M){var v,f,A;return{lift:b,warmup:[{pct_of_tm:.4,reps:5,load_rounded:0},{pct_of_tm:.5,reps:5,load_rounded:0},{pct_of_tm:.6,reps:3,load_rounded:0}],weeks:N(),supplemental:((v=e==null?void 0:e.supplemental)==null?void 0:v.strategy)==="bbb"?{mode:"bbb",sets:5,reps:10,pct_of_tm:(Number((f=e==null?void 0:e.supplemental)==null?void 0:f.percentOfTM)||50)/100,load_rounded:0}:{mode:null},assistance:[],conditioning_note:((A=e==null?void 0:e.conditioning)==null?void 0:A.note)||"Prowler pushes or hill sprints 2–3x weekly. Progress gradually."}}const t={press:u("press",r.press),deadlift:u("deadlift",r.deadlift),bench:u("bench",r.bench),squat:u("squat",r.squat)};return{meta:g,tm_by_lift:r,days:t}}function ee(){var m,i,g,y;const e=K(),r=L(),n=["press","deadlift","bench","squat"],l=!!((m=e==null?void 0:e.tm_by_lift)!=null&&m.press)&&!!((i=e==null?void 0:e.tm_by_lift)!=null&&i.bench)&&!!((g=e==null?void 0:e.tm_by_lift)!=null&&g.squat)&&!!((y=e==null?void 0:e.tm_by_lift)!=null&&y.deadlift)&&!!(e!=null&&e.days)&&Object.keys(e.days).length>0;function o(){var d,c;if(l)try{E(e,{upper:((d=e.meta.progression)==null?void 0:d.upper_inc)??5,lower:((c=e.meta.progression)==null?void 0:c.lower_inc)??10}),r("/program")}catch(p){console.error(p),alert("Could not start cycle. Verify Training Maxes and plan data.")}}return s.jsxs("main",{className:"mx-auto max-w-6xl px-4 py-8 text-gray-100",children:[s.jsx(U,{meta:e.meta}),s.jsx("section",{className:"mt-6",children:s.jsx(J,{tmByLift:e.tm_by_lift})}),s.jsx("section",{className:"mt-8 space-y-6",children:n.map(d=>s.jsx(V,{lift:d,day:e.days[d],tm:e.tm_by_lift[d],meta:e.meta},d))}),s.jsx(H,{onBack:()=>r(-1),onStartCycle:o,startDisabled:!l})]})}function U({meta:e}){return s.jsxs("header",{className:"mb-4",children:[s.jsx("h1",{className:"text-2xl font-semibold",children:"Final Review — 5/3/1 Plan"}),s.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[s.jsxs(h,{children:["Option: ",e.weekly_option==="opt1"?"1 (65/75/85 ▶︎ 95)":"2 (75/80/85 ▶︎ 95)"]}),s.jsx(h,{children:"AMRAP: On (Deload Off)"}),s.jsx(h,{children:"Warm‑up: 40/50/60"}),s.jsxs(h,{children:["Units/Rounding: ",e.units,", ",e.rounding.mode," ±",e.rounding.step]}),s.jsxs(h,{children:["Deadlift: ",e.deadlift_rep_style==="dead_stop"?"Dead‑stop":"Touch‑and‑go"]}),s.jsx(h,{children:"Schedule: 4‑day"}),s.jsxs(h,{children:["Next Cycle TM: +",e.progression.upper_inc," / +",e.progression.lower_inc]})]})]})}function J({tmByLift:e}){return s.jsxs("div",{className:"rounded-2xl border border-gray-700 bg-gray-800/70 p-6 shadow-sm backdrop-blur",children:[s.jsx("h2",{className:"mb-3 text-lg font-medium text-white",children:"Training Maxes (90% of 1RM)"}),s.jsx("div",{className:"grid grid-cols-1 gap-2 text-sm md:grid-cols-4",children:["press","bench","squat","deadlift"].map(r=>s.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-gray-700/70 bg-gray-900/60 p-3",children:[s.jsx("span",{className:"font-medium text-gray-200",children:W[r]}),s.jsx("span",{className:"tabular-nums text-gray-100",children:e[r]})]},r))}),s.jsxs("p",{className:"mt-3 text-xs text-gray-400",children:["All working percentages are based on ",s.jsx("strong",{className:"text-gray-200",children:"Training Max (TM)"}),", not true 1RM."]})]})}function V({lift:e,day:r,tm:n,meta:l}){var N,u;const o=l.rounding,m=r.warmup.map(t=>({...t,load_rounded:O(n,t.pct_of_tm,o.step,o.mode)})),[i,g]=q.useState("w1"),y=[{key:"w1",label:"Week 1"},{key:"w2",label:"Week 2"},{key:"w3",label:"Week 3"},{key:"w4_deload",label:"Deload"}],d=q.useMemo(()=>({sets:r.weeks[i].sets.map(a=>({...a,load_rounded:O(n,a.pct_of_tm,o.step,o.mode)}))}),[i,r.weeks,n,o]),c=(N=r.supplemental)!=null&&N.pct_of_tm?O(n,r.supplemental.pct_of_tm,o.step,o.mode):((u=r.supplemental)==null?void 0:u.load_rounded)??null,p=q.useMemo(()=>{var j,_;const t=d.sets.reduce((w,x,T)=>{const k=(x.reps.includes("+"),parseInt(x.reps));return w+k*x.load_rounded},0),a=c&&((j=r.supplemental)!=null&&j.sets)&&((_=r.supplemental)!=null&&_.reps)?c*r.supplemental.sets*r.supplemental.reps:0;return{main:t,supplemental:a,total:t+a}},[d,c,r.supplemental]);return s.jsxs("details",{className:"group rounded-2xl border border-gray-700 bg-gray-800/70 p-6 shadow-sm backdrop-blur",open:!0,children:[s.jsxs("summary",{className:"flex cursor-pointer list-none items-center justify-between",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-100",children:["Day — ",W[e]]}),s.jsxs("span",{className:"text-xs text-gray-400",children:["TM ",n]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("h4",{className:"mb-2 text-sm font-medium text-gray-200",children:"Warm‑up (40/50/60 × 5/5/3)"}),s.jsx("div",{className:"overflow-x-auto rounded border border-gray-700",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-800 text-gray-300",children:s.jsxs("tr",{children:[s.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"Set"}),s.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"% TM"}),s.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"Reps"}),s.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"Load"})]})}),s.jsx("tbody",{children:m.map((t,a)=>s.jsxs("tr",{className:`border-t border-gray-700 ${a%2?"bg-gray-900/80":"bg-gray-900"}`,children:[s.jsx("td",{className:"py-1 px-2 text-gray-200",children:a+1}),s.jsxs("td",{className:"py-1 px-2 text-gray-300",children:[Math.round(t.pct_of_tm*100),"%"]}),s.jsx("td",{className:"py-1 px-2 text-gray-300",children:t.reps}),s.jsxs("td",{className:"py-1 px-2 tabular-nums text-gray-100",children:[t.load_rounded,l.units]})]},a))})]})})]}),s.jsxs("div",{className:"mt-5",children:[s.jsx("div",{className:"mb-2 flex gap-2",children:y.map(t=>s.jsx("button",{onClick:()=>g(t.key),className:`rounded-full border px-3 py-1 text-xs transition-colors ${i===t.key?"bg-red-600 text-white border-red-500":"bg-gray-900/60 border-gray-700 text-gray-300 hover:bg-gray-900"}`,children:t.label},t.key))}),s.jsx("div",{className:"overflow-x-auto rounded border border-gray-700",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-800 text-gray-300",children:s.jsxs("tr",{children:[s.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"Set"}),s.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"% TM"}),s.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"Reps"}),s.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"Note"}),s.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"Load"})]})}),s.jsx("tbody",{children:d.sets.map((t,a)=>s.jsxs("tr",{className:`border-t border-gray-700 ${a%2?"bg-gray-900/80":"bg-gray-900"}`,children:[s.jsx("td",{className:"py-1 px-2 text-gray-200",children:t.set}),s.jsxs("td",{className:"py-1 px-2 text-gray-300",children:[Math.round(t.pct_of_tm*100),"%"]}),s.jsx("td",{className:"py-1 px-2 text-gray-300",children:t.reps}),s.jsx("td",{className:"py-1 px-2",children:t.amrap?s.jsx("span",{className:"rounded-full bg-amber-600/30 border border-amber-500/40 text-amber-200 px-2 py-0.5 text-[11px] font-medium tracking-wide",children:"AMRAP"}):s.jsx("span",{className:"text-gray-500",children:"—"})}),s.jsxs("td",{className:"py-1 px-2 tabular-nums text-gray-100",children:[t.load_rounded,l.units]})]},a))})]})})]}),s.jsxs("div",{className:"mt-5",children:[s.jsx("h4",{className:"mb-1 text-sm font-medium",children:"Supplemental"}),!r.supplemental||r.supplemental.mode===null?s.jsx("p",{className:"text-sm text-gray-500",children:"No supplemental today (Jack Shit)."}):r.supplemental.mode==="bbb"?s.jsxs("p",{className:"text-sm",children:["BBB — ",s.jsxs("span",{className:"font-medium",children:[r.supplemental.sets,"×",r.supplemental.reps]})," @"," ",r.supplemental.pct_of_tm?`${Math.round(r.supplemental.pct_of_tm*100)}% TM`:""," ",c?s.jsxs("span",{className:"tabular-nums",children:["→ ",c,l.units]}):null]}):s.jsxs("p",{className:"text-sm",children:[r.supplemental.mode.toUpperCase()," — ",r.supplemental.sets,"×",r.supplemental.reps," @ ",Math.round((r.supplemental.pct_of_tm??0)*100),"%"]})]}),s.jsxs("div",{className:"mt-5",children:[s.jsx("h4",{className:"mb-1 text-sm font-medium",children:"Assistance"}),s.jsx("ul",{className:"list-disc pl-5 text-sm",children:r.assistance.map((t,a)=>s.jsxs("li",{children:[s.jsx("span",{className:"font-medium",children:t.name})," ",t.bodyweight&&t.target_min_reps?s.jsxs(s.Fragment,{children:["— ≥",t.target_min_reps," reps (bodyweight)"]}):t.sets&&t.reps?s.jsxs(s.Fragment,{children:["— ",t.sets,"×",t.reps]}):null]},a))})]}),s.jsxs("div",{className:"mt-4 text-sm text-gray-300",children:[s.jsx("strong",{children:"Conditioning:"})," ",r.conditioning_note]}),s.jsxs("div",{className:"mt-4 text-sm",children:[s.jsx("span",{className:"mr-3",children:"Tonnage — "}),s.jsxs("span",{className:"mr-2",children:["Main: ",s.jsx("span",{className:"tabular-nums",children:p.main})]}),s.jsxs("span",{className:"mr-2",children:["Supplemental: ",s.jsx("span",{className:"tabular-nums",children:p.supplemental})]}),s.jsxs("span",{children:["Total: ",s.jsx("span",{className:"tabular-nums",children:p.total})]})]})]})}function h({children:e}){return s.jsx("span",{className:"inline-flex items-center rounded-full border px-2 py-1 text-xs",children:e})}function H({onBack:e,onStartCycle:r,startDisabled:n}){return s.jsxs("footer",{className:"sticky bottom-0 mt-10 flex justify-between gap-3 border-t border-gray-700 bg-gray-900/80 p-4 backdrop-blur",children:[s.jsx("button",{onClick:e,className:"rounded-lg border px-4 py-2",children:"Back"}),s.jsx("button",{onClick:r,disabled:n,className:`rounded-lg px-4 py-2 font-medium text-white ${n?"bg-red-300 cursor-not-allowed":"bg-red-600 hover:bg-red-700"}`,children:"Start Cycle"})]})}export{ee as default};
//# sourceMappingURL=BuilderReview-Cur-19NV.js.map
