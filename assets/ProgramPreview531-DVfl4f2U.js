import{r as U,j as e,T as E,l as $,f as A,P as L,af as K}from"./ui-vendor-BLoy3R85.js";import{r as B,d as q,a as _}from"./compute531-BdiGZ_3o.js";import{x as J,t as z,p as G}from"./index-BJgVdXSK.js";import"./react-vendor-DoC2WAmd.js";import"./data-vendor-CWegSrCC.js";import"./chart-vendor-DbvXzfx8.js";import"./router-vendor-CDc5MEim.js";const F=[{pct:40,reps:5},{pct:50,reps:5},{pct:60,reps:3}],V=[{pct:50,reps:5},{pct:60,reps:3}];function H(s,N,i={increment:5,mode:"nearest"}){if(!Number.isFinite(s))return[];const o=(i==null?void 0:i.increment)??5,h=(i==null?void 0:i.mode)??"nearest";return(N||[]).map(u=>({pct:u.pct,reps:u.reps,weight:B(s*(u.pct/100),o,h)}))}function I(s,N,i,o){const h=s==="minimal"?V:s==="custom"&&N&&N.length?N:F;return H(i,h,o)}function ne({data:s,updateData:N}){var k,D,C,R,T;const i=U.useMemo(()=>J(s),[s]),o=U.useMemo(()=>{try{return q(s)}catch(r){return console.warn("Program generation error:",r),null}},[s]),h=Object.values(i).filter(r=>r==="complete").length,u=Object.keys(i).length,M=Object.values(i).some(r=>r==="error"),O=r=>{if(o)switch(r){case"json":{const t=new Blob([JSON.stringify(o,null,2)],{type:"application/json"}),l=URL.createObjectURL(t),m=document.createElement("a");m.href=l,m.download=`531-program-${Date.now()}.json`,m.click(),URL.revokeObjectURL(l);break}case"print":{window.print();break}}},W=(r,t)=>r!=null&&r.days?e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-lg font-semibold mb-3 text-green-400",children:["Week ",t]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.days.map((l,m)=>e.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded p-3",children:[e.jsxs("h5",{className:"font-medium text-red-400 mb-2",children:["Day ",m+1," - ",l.focus]}),(()=>{var p,g,n,b,c;const a=(((p=s==null?void 0:s.schedule)==null?void 0:p.days)||[])[m],v=a==null?void 0:a.lift,j=(g=s==null?void 0:s.trainingMaxes)==null?void 0:g[v],y=(s==null?void 0:s.rounding)||{increment:5,mode:"nearest"},x=((n=s==null?void 0:s.warmup)==null?void 0:n.policy)||"standard",f=((b=s==null?void 0:s.warmup)==null?void 0:b.custom)||[],d=I(x,f,Number(j),y);return d!=null&&d.length?e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-300 mb-1",children:"Warm‑Up"}),e.jsxs("div",{className:"text-xs text-gray-400 space-y-1",children:[d.map((w,S)=>e.jsxs("div",{children:[w.weight,"lb × ",w.reps," (",w.pct,"%)"]},S)),v==="deadlift"&&((c=s==null?void 0:s.warmup)==null?void 0:c.deadliftRepStyle)==="deadstop"&&e.jsx("div",{className:"text-gray-500",children:"Cue: reset each rep (dead‑stop)"})]})]}):null})(),(()=>{var p,g,n,b;const a=(((p=s==null?void 0:s.schedule)==null?void 0:p.days)||[])[m],v=a==null?void 0:a.lift,j=Number((g=s==null?void 0:s.trainingMaxes)==null?void 0:g[v]),y=(s==null?void 0:s.rounding)||{increment:5,mode:"nearest"},x=Number((n=s==null?void 0:s.loading)==null?void 0:n.previewWeek)||1,f=Number((b=s==null?void 0:s.loading)==null?void 0:b.option)||1,d=Number.isFinite(j)?_(j,f,x,y):[];return d.length?e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-300 mb-1",children:"Main Sets"}),e.jsx("div",{className:"text-xs text-gray-400 space-y-1",children:d.map(c=>e.jsxs("div",{children:[c.pct,"% × ",c.reps,c.amrap?"+":""," → ",Number.isFinite(c.weight)?`${c.weight}lb`:"-"]},c.set||`${c.pct}-${c.reps}`))})]}):null})(),(()=>{var f,d,p,g;const v=(d=(((f=s==null?void 0:s.schedule)==null?void 0:f.days)||[])[m])==null?void 0:d.lift,j=((g=(p=s==null?void 0:s.assistance)==null?void 0:p.perDay)==null?void 0:g[v])||[],y=(s==null?void 0:s.rounding)||{increment:5},x=(s==null?void 0:s.lifts)||{};return e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-300 mb-1",children:"Assistance"}),j.length?e.jsx("ul",{className:"text-xs text-gray-400 space-y-1",children:j.map((n,b)=>{var c,w,S;return e.jsxs("li",{children:[n.name,": ",n.sets,"×",n.reps,((c=n==null?void 0:n.load)==null?void 0:c.type)==="percentTM"&&e.jsxs(e.Fragment,{children:[" @ ",n.load.value,"% TM",Number.isFinite(Number((w=x==null?void 0:x[n.load.liftRef])==null?void 0:w.tm))?e.jsxs(e.Fragment,{children:[" → ",e.jsx("span",{className:"font-mono",children:z(G(Number(x[n.load.liftRef].tm),Number(n.load.value),(y==null?void 0:y.increment)??5))})]}):null]}),((S=n==null?void 0:n.load)==null?void 0:S.type)==="bw"&&" @ BW"]},b)})}):e.jsx("div",{className:"text-xs text-gray-500",children:"None"})]})})(),l.conditioning&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-300 mb-1",children:"Conditioning"}),e.jsxs("div",{className:"text-xs text-gray-400",children:[l.conditioning.type,": ",l.conditioning.description]})]})]},m))})]},t):null;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Program Preview"}),e.jsxs("p",{className:"text-gray-400",children:[h,"/",u," steps completed"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:M?e.jsxs("div",{className:"flex items-center gap-2 text-yellow-400",children:[e.jsx(E,{className:"w-5 h-5"}),e.jsx("span",{children:"Validation errors"})]}):h===u?e.jsxs("div",{className:"flex items-center gap-2 text-green-400",children:[e.jsx($,{className:"w-5 h-5"}),e.jsx("span",{children:"Ready to export"})]}):e.jsx("span",{className:"text-gray-400",children:"In progress..."})})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${M?"bg-yellow-500":"bg-green-500"}`,style:{width:`${h/u*100}%`}})})]}),o&&e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Export Options"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>O("json"),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg",children:[e.jsx(A,{className:"w-4 h-4"}),"Download JSON"]}),e.jsxs("button",{onClick:()=>O("print"),className:"flex items-center gap-2 px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg",children:[e.jsx(L,{className:"w-4 h-4"}),"Print Program"]}),e.jsxs("button",{disabled:!0,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 text-gray-400 rounded-lg cursor-not-allowed",title:"Supabase integration coming soon",children:[e.jsx(K,{className:"w-4 h-4"}),"Save to Cloud"]})]})]}),o?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Program Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Template:"})," ",((k=s.templateChoice)==null?void 0:k.id)||"Custom"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Frequency:"})," ",((D=s.schedule)==null?void 0:D.frequency)||"4-day"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Training Max %:"})," ",((C=s.trainingMaxes)==null?void 0:C.tmPercent)||90,"%"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Loading Option:"})," ",((R=s.cycle)==null?void 0:R.loadingOption)||1]})]})]}),(()=>{const r=(s==null?void 0:s.conditioning)||{},t=(r==null?void 0:r.weeklyPlan)||[];return e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("div",{className:"text-xs text-gray-400 uppercase tracking-wide mb-2",children:"Conditioning (Weekly)"}),t.length?e.jsx("ul",{className:"text-sm text-gray-200",children:t.map((l,m)=>e.jsxs("li",{children:[l.day,": ",String(l.mode).toUpperCase()," — ",l.modality," ",l.prescription&&Object.keys(l.prescription).length?e.jsxs("span",{className:"text-gray-400",children:["(",Object.entries(l.prescription).map(([P,a])=>`${P}:${a}`).join(", "),")"]}):null,l.notes?e.jsxs("span",{className:"text-gray-500",children:[" — ",l.notes]}):null]},m))}):e.jsx("div",{className:"text-gray-500 text-sm",children:"No conditioning scheduled."})]})})(),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Training Maxes"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:Object.entries(s.trainingMaxes||{}).map(([r,t])=>r==="tmPercent"||r==="rounding"||!t?null:e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-400 capitalize",children:[r.replace("_"," "),":"]}),e.jsxs("div",{className:"font-medium",children:[t,"lb"]})]},r))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-xl font-semibold",children:"4-Week Cycle"}),(T=o.weeks)==null?void 0:T.slice(0,3).map((r,t)=>W(r,t+1)),o.deloadWeek&&W(o.deloadWeek,4)]})]}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-8 text-center",children:[e.jsx(E,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Program Generation Error"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Unable to generate program preview. Please complete required steps and fix any validation errors."}),e.jsx("div",{className:"text-sm text-gray-500",children:"Missing data: Training maxes, template selection, or schedule configuration"})]})]})}export{ne as default};
//# sourceMappingURL=ProgramPreview531-DVfl4f2U.js.map
