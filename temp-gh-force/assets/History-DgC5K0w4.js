import{r as x,j as e,a3 as k,A,f as u,a4 as C,a5 as O,y as L,a6 as P,a7 as B}from"./ui-vendor-BLoy3R85.js";import{g as b,c as v,d as E,l as j,f as D,a as M}from"./pr-DSANiz0l.js";import{b as F}from"./persistCycle-C-xkEUXV.js";import{L as w}from"./router-vendor-CDc5MEim.js";import"./react-vendor-DoC2WAmd.js";import"./index-DVfXjkeJ.js";import"./data-vendor-CWegSrCC.js";import"./chart-vendor-DbvXzfx8.js";function y({title:n,children:c,right:r}){return e.jsxs("div",{className:"bg-gray-900/60 border border-gray-700 rounded p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-white font-medium",children:n}),e.jsx("div",{children:r})]}),c]})}function p({label:n,value:c}){return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-gray-400 text-xs",children:n}),e.jsx("div",{className:"text-white font-semibold",children:c})]})}function T({children:n}){return e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded bg-red-600/20 text-red-300 border border-red-600/40 text-xs",children:n})}function J(n){const r=[["when","week","day","lift","tm","setIndex","weight","reps","amrap","e1RM","notes"].join(",")];for(const l of n){const d=j(l),a=M(l);(l.mainSets||[]).forEach((m,h)=>{const s=(h===l.mainSets.length-1||m.amrap)&&(a==null?void 0:a.e1RM)||"";r.push([JSON.stringify(l.when),l.week??"",JSON.stringify(l.day),JSON.stringify(d),l.tm??"",h+1,m.weight??"",m.loggedReps??"",m.amrap?"Y":"",s,JSON.stringify(l.notes||"")].join(","))})}return r.join(`
`)}function R(n,c,r="text/plain"){const l=new Blob([c],{type:r}),d=URL.createObjectURL(l),a=document.createElement("a");a.href=d,a.download=n,a.click(),setTimeout(()=>URL.revokeObjectURL(d),1e3)}function q(){const[n,c]=x.useState("All"),r=x.useMemo(()=>b(),[]),l=x.useMemo(()=>v(r),[r]),d=x.useMemo(()=>E(r),[r]),a=x.useMemo(()=>F(),[]),m=x.useMemo(()=>{const s=new Set(r.map(j).filter(Boolean));return["All",...Array.from(s)]},[r]),h=x.useMemo(()=>r.slice().reverse().filter(s=>n==="All"?!0:j(s)===n),[r,n]);return e.jsxs("div",{className:"max-w-6xl mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-6 h-6 text-red-400"}),e.jsx("h2",{className:"text-2xl text-white font-semibold",children:"History & PRs"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{to:"/print-week",className:"inline-flex items-center gap-2 px-3 py-2 rounded border border-gray-600 text-gray-100 hover:bg-gray-800 text-sm",children:"Print Week"}),e.jsxs(w,{to:"/train",className:"inline-flex items-center gap-2 px-3 py-2 rounded bg-red-600 hover:bg-red-700 text-white text-sm",children:[e.jsx(A,{className:"w-4 h-4"})," Train Today"]}),e.jsxs("button",{onClick:()=>R("history.json",JSON.stringify(r,null,2),"application/json"),className:"inline-flex items-center gap-2 px-3 py-2 rounded border border-gray-600 text-gray-100 hover:bg-gray-800 text-sm",children:[e.jsx(u,{className:"w-4 h-4"})," Export JSON"]}),e.jsxs("button",{onClick:()=>R("history.csv",J(r),"text/csv"),className:"inline-flex items-center gap-2 px-3 py-2 rounded border border-gray-600 text-gray-100 hover:bg-gray-800 text-sm",children:[e.jsx(u,{className:"w-4 h-4"})," Export CSV"]}),e.jsxs("button",{onClick:()=>{confirm("Clear all history? This cannot be undone.")&&(D(),location.reload())},className:"inline-flex items-center gap-2 px-3 py-2 rounded border border-red-700/60 text-red-300 hover:bg-red-900/20 text-sm",title:"Clear local history",children:[e.jsx(C,{className:"w-4 h-4"})," Clear"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(y,{title:"Cycle Status",right:e.jsx(O,{className:"w-4 h-4 text-gray-400"}),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(p,{label:"Status",value:(a==null?void 0:a.status)||"active"}),e.jsx(p,{label:"Week",value:(a==null?void 0:a.currentWeek)??"-"}),e.jsx(p,{label:"Day",value:((a==null?void 0:a.currentDayIndex)??0)+1})]})}),e.jsx(y,{title:"Best e1RM by Lift",right:e.jsx(L,{className:"w-4 h-4 text-yellow-400"}),children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[Object.keys(l).length===0&&e.jsx("div",{className:"text-gray-400",children:"No PRs yet."}),Object.entries(l).map(([s,i])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-gray-300",children:s}),e.jsxs("div",{className:"text-white font-mono",children:[i.e1RM," lb"]})]},s))]})}),e.jsx(y,{title:"Filter",right:e.jsx(P,{className:"w-4 h-4 text-gray-400"}),children:e.jsx("select",{value:n,onChange:s=>c(s.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded px-2 py-1 text-gray-100",children:m.map(s=>e.jsx("option",{value:s,children:s},s))})})]}),e.jsx(y,{title:"Rep Records (by AMRAP weight)",children:Object.keys(d).length===0?e.jsx("div",{className:"text-gray-400 text-sm",children:"No rep records yet."}):Object.entries(d).map(([s,i])=>e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-white font-semibold mb-1",children:s}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-gray-400",children:[e.jsx("th",{className:"text-left py-1",children:"Weight (lb)"}),e.jsx("th",{className:"text-left py-1",children:"Best Reps"}),e.jsx("th",{className:"text-left py-1",children:"e1RM"}),e.jsx("th",{className:"text-left py-1",children:"When"})]})}),e.jsx("tbody",{children:Object.entries(i).sort((g,t)=>Number(g[0])-Number(t[0])).map(([g,t])=>e.jsxs("tr",{className:"border-t border-gray-800",children:[e.jsx("td",{className:"py-1 text-gray-200 font-mono",children:g}),e.jsx("td",{className:"py-1 text-gray-200",children:t.reps}),e.jsx("td",{className:"py-1 text-gray-200 font-mono",children:t.e1RM}),e.jsx("td",{className:"py-1 text-gray-400",children:new Date(t.when).toLocaleString()})]},g))})]})})]},s))}),e.jsx(y,{title:`Sessions (${h.length})`,children:h.length===0?e.jsx("div",{className:"text-gray-400 text-sm",children:"No sessions found."}):e.jsx("div",{className:"space-y-2",children:h.map(s=>{const i=M(s),g=(()=>{const t=j(s),o=v(b().filter(f=>f.when<s.when&&j(f)===t))[t],S=(o==null?void 0:o.e1RM)??0,N=((i==null?void 0:i.e1RM)??Number((s==null?void 0:s.e1RM)??0))||0;return N&&N>S})();return e.jsxs("div",{className:"border border-gray-800 rounded p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-white font-medium",children:[j(s)," — Week ",s.week,", Day ",Number(s.dayIndex??s.dayIndex)+1||"?"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[g&&e.jsx(T,{children:"PR"}),e.jsx("div",{className:"text-xs text-gray-400",children:new Date(s.when).toLocaleString()})]})]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-300",children:[s.day&&e.jsxs("span",{className:"text-gray-400 mr-2",children:[s.day," ·"]}),"TM: ",e.jsx("span",{className:"font-mono",children:s.tm??"-"}),i!=null&&i.e1RM?e.jsxs(e.Fragment,{children:[" · ","e1RM: ",e.jsxs("span",{className:"font-mono",children:[i.e1RM," lb"]})," · ","AMRAP: ",e.jsxs("span",{className:"font-mono",children:[i.weight,"×",i.reps]})]}):null]}),e.jsxs("details",{className:"mt-2",children:[e.jsxs("summary",{className:"text-gray-400 text-xs inline-flex items-center gap-1 cursor-pointer",children:[e.jsx(B,{className:"w-3 h-3"})," Sets"]}),e.jsx("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-2",children:(s.mainSets||[]).map((t,o)=>e.jsxs("div",{className:"bg-gray-900/40 border border-gray-800 rounded px-2 py-1 text-sm text-gray-300",children:["Set ",o+1,": ",e.jsxs("span",{className:"font-mono",children:[t.weight," lb"]})," · ",t.amrap?e.jsx("span",{className:"text-red-300",children:"AMRAP"}):e.jsxs("span",{children:[t.reps??t.targetReps??t.minReps," reps"]}),t.loggedReps!=null&&e.jsxs(e.Fragment,{children:[" "," · ","logged: ",e.jsx("span",{className:"font-mono",children:t.loggedReps})]})]},o))}),(s.assistance||[]).length>0&&e.jsxs("div",{className:"mt-2 text-sm text-gray-400",children:["Assistance: ",(s.assistance||[]).map((t,o)=>t.name||t.title||`Ex ${o+1}`).join(", ")]}),s.notes&&e.jsxs("div",{className:"mt-2 text-sm text-gray-400",children:["Notes: ",s.notes]})]})]},s.id)})})})]})}export{q as default};
//# sourceMappingURL=History-DgC5K0w4.js.map
