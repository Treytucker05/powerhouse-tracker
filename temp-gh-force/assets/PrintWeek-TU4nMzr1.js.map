{"version":3,"file":"PrintWeek-TU4nMzr1.js","sources":["../../src/lib/fiveThreeOne/validate.js","../../src/lib/fiveThreeOne/stateBridge.js","../../src/pages/PrintWeek.jsx"],"sourcesContent":["// src/lib/fiveThreeOne/validate.js\r\nexport function validateTM(tm, oneRM) {\r\n    const t = Number(tm || 0), m = Number(oneRM || 0);\r\n    if (!t || !m) return { ok: false, level: 'error', msg: 'Missing TM or 1RM' };\r\n    const ratio = t / m;\r\n    if (ratio > 0.95) return { ok: false, level: 'warn', msg: 'TM too high (>95% of 1RM). Reduce for safety.' };\r\n    if (ratio < 0.80) return { ok: true, level: 'info', msg: 'TM very conservative (<80% of 1RM). This is okay if desired.' };\r\n    return { ok: true, level: 'ok', msg: 'TM in recommended range.' };\r\n}\r\n\r\n// three warm-up sets at 40/50/60% TM\r\nexport function getStandardWarmups(tm) {\r\n    const TM = Number(tm || 0);\r\n    return [\r\n        { pct: 40, reps: 5, weight: TM * 0.40 },\r\n        { pct: 50, reps: 5, weight: TM * 0.50 },\r\n        { pct: 60, reps: 3, weight: TM * 0.60 },\r\n    ];\r\n}\r\n","// src/lib/fiveThreeOne/stateBridge.js\r\n// Pulls program config from context if available, else from localStorage.\r\n// Keeps this page decoupled from your internal state shape.\r\n\r\nexport function getLocal(key, def) {\r\n    try { const v = JSON.parse(localStorage.getItem(key) || 'null'); return v ?? def; }\r\n    catch { return def; }\r\n}\r\n\r\nexport function getTrainingMaxesFromAny(contextMaybe) {\r\n    // Try ProgramContext-like shape\r\n    if (contextMaybe?.trainingMaxes) return contextMaybe.trainingMaxes;\r\n    // Try known localStorage key\r\n    return getLocal('trainingMaxes', {\r\n        squat: 0, bench: 0, deadlift: 0, press: 0\r\n    });\r\n}\r\n\r\nexport function getLoadingOptionFromAny(contextMaybe) {\r\n    if (contextMaybe?.loadingOption) return contextMaybe.loadingOption; // 1 or 2\r\n    return Number(localStorage.getItem('loadingOption') || 1);\r\n}\r\n\r\nexport function getLiftOrderFromAny(contextMaybe) {\r\n    if (contextMaybe?.liftOrder) return contextMaybe.liftOrder;\r\n    return ['press', 'deadlift', 'bench', 'squat']; // canonical default\r\n}\r\n\r\nexport function getClientMetaFromAny(contextMaybe) {\r\n    const def = { clientName: 'Client', startDate: null };\r\n    if (!contextMaybe) return { ...def, ...getLocal('clientMeta', {}) };\r\n    return {\r\n        clientName: contextMaybe.clientName || def.clientName,\r\n        startDate: contextMaybe.startDate || def.startDate,\r\n    };\r\n}\r\n","// src/pages/PrintWeek.jsx\nimport React, { useMemo, useState } from 'react';\nimport { useSettings } from '../contexts/SettingsContext.jsx';\nimport { percentOfTM, toDisplayWeight } from '../lib/fiveThreeOne/math';\nimport { getStandardWarmups } from '../lib/fiveThreeOne/validate';\nimport { getTrainingMaxesFromAny, getLoadingOptionFromAny, getLiftOrderFromAny, getClientMetaFromAny } from '../lib/fiveThreeOne/stateBridge.js';\nimport './print.css';\n\nconst LOADS = {\n    1: [ // Option 1 (default)\n        { pct: 65, reps: 5, amrap: false },\n        { pct: 75, reps: 5, amrap: false },\n        { pct: 85, reps: 5, amrap: true },\n    ],\n    2: [\n        { pct: 75, reps: 5, amrap: false },\n        { pct: 80, reps: 5, amrap: false },\n        { pct: 85, reps: 5, amrap: true },\n    ],\n    3: [\n        { pct: 75, reps: 5, amrap: false },\n        { pct: 85, reps: 3, amrap: false },\n        { pct: 95, reps: 1, amrap: true },\n    ],\n    4: [\n        { pct: 40, reps: 5, amrap: false },\n        { pct: 50, reps: 5, amrap: false },\n        { pct: 60, reps: 5, amrap: false },\n    ],\n};\n\n// per-week mapping depends on loading option 1 vs 2\nfunction getWeekSets(week, loadingOption = 1) {\n    if (Number(week) === 1) return loadingOption === 1 ? LOADS[1] : LOADS[2];\n    if (Number(week) === 2) return [\n        ...(loadingOption === 1\n            ? [{ pct: 70, reps: 3 }, { pct: 80, reps: 3 }, { pct: 90, reps: 3, amrap: true }]\n            : [{ pct: 80, reps: 3 }, { pct: 85, reps: 3 }, { pct: 90, reps: 3, amrap: true }]\n        ),\n    ];\n    if (Number(week) === 3) return LOADS[3];\n    if (Number(week) === 4) return LOADS[4];\n    return LOADS[1];\n}\n\nconst LIFT_LABELS = {\n    squat: 'Squat',\n    bench: 'Bench Press',\n    deadlift: 'Deadlift',\n    press: 'Overhead Press', // consolidated single key\n};\n\nfunction liftKeysFromOrder(order) {\n    // Normalize possible values\n    return order.map(k => (k === 'press' ? 'press' : k));\n}\n\nexport default function PrintWeek() {\n    const { unit, roundingIncrement } = useSettings();\n    const [week, setWeek] = useState(() => {\n        const urlWeek = new URLSearchParams(location.search).get('week');\n        return Number(urlWeek || 1);\n    });\n\n    // Try to read any context you may have passed down (not required here)\n    const programContext = null;\n\n    const trainingMaxes = useMemo(\n        () => getTrainingMaxesFromAny(programContext),\n        [programContext]\n    );\n    const loadingOption = useMemo(\n        () => getLoadingOptionFromAny(programContext),\n        [programContext]\n    );\n    const liftOrder = useMemo(\n        () => liftKeysFromOrder(getLiftOrderFromAny(programContext)),\n        [programContext]\n    );\n    const clientMeta = useMemo(\n        () => getClientMetaFromAny(programContext),\n        [programContext]\n    );\n\n    const dayRows = liftOrder.map((liftKey) => {\n        const tm = Number(trainingMaxes?.[liftKey]) || 0;\n        const warmups = getStandardWarmups(tm).map(w => ({\n            ...w,\n            weight: toDisplayWeight(w.weight),\n        }));\n        const mainSets = getWeekSets(week, loadingOption).map(s => {\n            const weight = toDisplayWeight(percentOfTM(tm, s.pct, roundingIncrement));\n            return { ...s, weight };\n        });\n        return { liftKey, liftName: LIFT_LABELS[liftKey] || liftKey, warmups, mainSets, tm };\n    });\n\n    return (\n        <div className=\"print-container\">\n            <div className=\"print-toolbar no-print\">\n                <div className=\"left\">\n                    <h1>Print Week</h1>\n                    <div className=\"sub\">\n                        {clientMeta.clientName} • Unit: {unit} • Rounding: {roundingIncrement} {unit}\n                    </div>\n                </div>\n                <div className=\"right\">\n                    <label>Week: </label>\n                    <select value={week} onChange={e => setWeek(Number(e.target.value))}>\n                        <option value={1}>Week 1</option>\n                        <option value={2}>Week 2</option>\n                        <option value={3}>Week 3</option>\n                        <option value={4}>Deload</option>\n                    </select>\n                    <button onClick={() => window.print()} className=\"btn\">Print</button>\n                </div>\n            </div>\n\n            <div className=\"sheet\">\n                <div className=\"sheet-header\">\n                    <div>\n                        <div className=\"title\">{clientMeta.clientName} — 5/3/1 Program</div>\n                        <div className=\"meta\">Week {week} • Loading Option {loadingOption} • Unit: {unit}</div>\n                    </div>\n                    <div className=\"notes\">Notes:</div>\n                </div>\n\n                {dayRows.map((row, idx) => (\n                    <div className=\"day\" key={row.liftKey}>\n                        <div className=\"day-hd\">{idx + 1}. {row.liftName} (TM: {toDisplayWeight(row.tm)} {unit})</div>\n                        <table className=\"tbl\">\n                            <thead>\n                                <tr>\n                                    <th>Type</th><th>% TM</th><th>Reps</th><th>Weight</th><th>Check</th><th>Notes</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {row.warmups.map((w, i) => (\n                                    <tr key={`w${i}`}>\n                                        <td>Warm‑up</td>\n                                        <td>{w.pct}%</td>\n                                        <td>{w.reps}</td>\n                                        <td>{w.weight} {unit}</td>\n                                        <td><input type=\"checkbox\" /></td>\n                                        <td></td>\n                                    </tr>\n                                ))}\n                                {row.mainSets.map((s, i) => (\n                                    <tr key={`m${i}`}>\n                                        <td>{i < row.mainSets.length - 1 ? 'Set' : (s.amrap ? 'Top +' : 'Set')}</td>\n                                        <td>{s.pct}%</td>\n                                        <td>{s.reps}{s.amrap ? '+' : ''}</td>\n                                        <td>{s.weight} {unit}</td>\n                                        <td><input type=\"checkbox\" /></td>\n                                        <td></td>\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                    </div>\n                ))}\n\n                <div className=\"footer\">\n                    Generated by Powerhouse Tracker • {new Date().toLocaleDateString()}\n                </div>\n            </div>\n        </div>\n    );\n}\n"],"names":["getStandardWarmups","tm","TM","getLocal","key","def","getTrainingMaxesFromAny","contextMaybe","getLoadingOptionFromAny","getLiftOrderFromAny","getClientMetaFromAny","LOADS","getWeekSets","week","loadingOption","LIFT_LABELS","liftKeysFromOrder","order","k","PrintWeek","unit","roundingIncrement","useSettings","setWeek","useState","urlWeek","programContext","trainingMaxes","useMemo","liftOrder","clientMeta","dayRows","liftKey","warmups","w","toDisplayWeight","mainSets","s","weight","percentOfTM","jsxs","jsx","e","row","idx","i"],"mappings":"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"}