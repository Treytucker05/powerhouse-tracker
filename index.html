<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PowerHouseATX Workout Calculator - Advanced Intelligence</title>

<!-- PWA Configuration -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#667eea">
<meta name="description" content="Advanced AI-powered training intelligence system for optimal workout programming and progression">
<link rel="icon" href="/assets/favicon.ico" />

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="css/enhancedAdvanced.css">
<style>
/* --- Global Styles & Resets --- */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  scroll-behavior: smooth;
}

body {
  background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
  color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
  line-height: 1.6;
  padding: 20px;
  min-height: 100vh;
  position: relative;
  overflow-x: hidden;
}

/* Animated background effect */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-image:
    radial-gradient(circle at 20% 80%, rgba(255, 0, 0, 0.1) 0%, transparent 50%),
    radial-gradient(circle at 80% 20%, rgba(255, 0, 0, 0.05) 0%, transparent 50%),
    radial-gradient(circle at 40% 40%, rgba(255, 0, 0, 0.03) 0%, transparent 50%);
  pointer-events: none;
  z-index: 1;
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 10px;
}

::-webkit-scrollbar-track {
  background: #0a0a0a;
}

::-webkit-scrollbar-thumb {
  background: #FF0000;
  border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
  background: #cc0000;
}

/* --- Main Container --- */
.container {
  max-width: 1400px;
  margin: 0 auto;
  position: relative;
  z-index: 2;
  width: 100%;
}

/* --- Header & Typography --- */
.header-section {
  text-align: center;
  margin-bottom: 40px;
  position: relative;
  background: rgba(26, 26, 26, 0.95);
  backdrop-filter: blur(10px);
  padding: 35px;
  border: 1px solid rgba(255, 0, 0, 0.3);
  border-radius: 16px;
  box-shadow:
    0 8px 32px rgba(0, 0, 0, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

h1 {
  font-size: 3.5rem;
  font-weight: 900;
  background: linear-gradient(135deg, #FF0000 0%, #ff6b6b 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 0.25rem;
  text-transform: uppercase;
  letter-spacing: -1.5px;
  line-height: 1;
  text-shadow: 0 0 40px rgba(255, 0, 0, 0.5);
}

.page-title {
  font-size: 2.2rem;
  font-weight: 700;
  color: #e0e0e0;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 1rem;
  text-shadow: 0 0 10px rgba(255,255,255,0.1);
}

.subtitle {
  font-size: 1.1rem;
  color: #999;
  font-weight: 300;
  letter-spacing: 1px;
}

/* RP Status Display */
.rp-status {
  background: rgba(0, 0, 0, 0.3);
  padding: 20px;
  border-radius: 12px;
  margin: 20px 0;
  border: 1px solid rgba(255, 0, 0, 0.2);
}

.status-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 15px;
}

.status-item {
  text-align: center;
  padding: 10px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 8px;
}

.status-value {
  font-size: 1.8rem;
  font-weight: 700;
  color: #FF0000;
}

.status-label {
  font-size: 0.9rem;
  color: #ccc;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* Chart Section */
.chart-section {
  background: rgba(26, 26, 26, 0.95);
  backdrop-filter: blur(10px);
  padding: 35px;
  border: 1px solid rgba(255, 0, 0, 0.3);
  border-radius: 16px;
  margin: 20px 0;
  box-shadow:
    0 8px 32px rgba(0, 0, 0, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.chart-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  flex-wrap: wrap;
  gap: 10px;
}

.chart-controls {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.chart-controls button {
  padding: 8px 16px;
  font-size: 0.9rem;
  margin: 0;
}

#weeklyChart {
  max-height: 400px;
}

/* Volume Status Indicators */
.volume-status {
  margin-top: 15px;
}

.volume-analysis {
  display: flex;
  align-items: center;
  gap: 15px;
  flex-wrap: wrap;
}

.status-indicator {
  padding: 8px 16px;
  border-radius: 20px;
  font-weight: 700;
  font-size: 0.9rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.status-indicator.under-minimum { background: #ff4444; color: white; }
.status-indicator.maintenance { background: #ffaa00; color: white; }
.status-indicator.optimal { background: #44ff44; color: black; }
.status-indicator.high { background: #ffff44; color: black; }
.status-indicator.maximum { background: #ff4444; color: white; }

.landmarks-display {
  display: flex;
  gap: 15px;
  flex-wrap: wrap;
}

.landmarks-display span {
  padding: 4px 8px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 4px;
  font-size: 0.8rem;
}

/* Section Banners */
.section-banner {
  background: linear-gradient(135deg, rgba(255, 0, 0, 0.2) 0%, rgba(255, 0, 0, 0.1) 100%);
  padding: 20px;
  margin: 40px 0 20px 0;
  border-radius: 12px;
  border: 1px solid rgba(255, 0, 0, 0.3);
  text-align: center;
  cursor: pointer;
  transition: all 0.3s ease;
  user-select: none;
}

.section-banner:hover {
  background: linear-gradient(135deg, rgba(255, 0, 0, 0.3) 0%, rgba(255, 0, 0, 0.15) 100%);
}

.section-banner h3 {
  font-size: 1.8rem;
  font-weight: 700;
  color: #fff;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.expand-icon {
  font-size: 1.2rem;
  transition: transform 0.3s ease;
}

.section-banner.expanded .expand-icon {
  transform: rotate(180deg);
}

/* Collapsible sections */
.section-content {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.4s ease;
}

.section-content.expanded {
  max-height: 3000px;
}

/* Calculator Grid */
.calculator-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
  gap: 2rem;
  margin-top: 2rem;
}

/* Calculator Cards */
.calculator {
  background: rgba(26, 26, 26, 0.95);
  backdrop-filter: blur(10px);
  padding: 35px;
  border: 1px solid rgba(255, 0, 0, 0.3);
  border-radius: 16px;
  margin: 20px 0;
  box-shadow:
    0 8px 32px rgba(0, 0, 0, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
  transition: all 0.3s ease;
}

.calculator:hover {
  border-color: rgba(255, 0, 0, 0.5);
  transform: translateY(-2px);
  box-shadow:
    0 12px 40px rgba(0, 0, 0, 0.5),
    0 0 20px rgba(255, 0, 0, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.calculator h2 {
  font-size: 2rem;
  font-weight: 700;
  color: #fff;
  margin-bottom: 1.5rem;
  padding-bottom: 0.75rem;
  border-bottom: 3px solid #FF0000;
  position: relative;
}

.calculator h2::after {
  content: '';
  position: absolute;
  bottom: -3px;
  left: 0;
  width: 60px;
  height: 3px;
  background: linear-gradient(90deg, #FF0000 0%, transparent 100%);
}

/* Form Elements */
.input-group {
  margin-bottom: 1.5rem;
}

label {
  display: block;
  color: #fff;
  font-weight: 600;
  margin-bottom: 10px;
  font-size: 0.95rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

input[type="number"], select {
  width: 100%;
  padding: 14px 16px;
  background: rgba(0, 0, 0, 0.5);
  color: #fff;
  border: 2px solid rgba(255, 255, 255, 0.1);
  border-radius: 10px;
  font-size: 1rem;
  transition: all 0.3s ease;
  font-weight: 500;
}

input[type="number"]:focus, select:focus {
  outline: none;
  border-color: #FF0000;
  box-shadow:
    0 0 0 4px rgba(255, 0, 0, 0.1),
    inset 0 0 0 1px rgba(255, 0, 0, 0.2);
  background: rgba(0, 0, 0, 0.7);
}

/* RIR Validation Styling */
input.rir-good {
  border-color: #4CAF50;
  box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
}

input.rir-warning {
  border-color: #ff9800;
  box-shadow: 0 0 0 2px rgba(255, 152, 0, 0.2);
}

input.rir-danger {
  border-color: #f44336;
  box-shadow: 0 0 0 2px rgba(244, 67, 54, 0.2);
}

/* Radio buttons */
.radio-group {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
  margin-top: 10px;
}

.radio-group label {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 1rem;
  font-weight: 500;
  text-transform: none;
  letter-spacing: normal;
  margin: 0;
  cursor: pointer;
}

input[type="radio"] {
  width: auto;
  margin: 0;
  transform: scale(1.2);
  accent-color: #FF0000;
}

input[type="checkbox"] {
  margin-right: 0.5rem;
  transform: scale(1.5);
  accent-color: #FF0000;
}

.helper-text {
  font-size: 0.875rem;
  color: #bbb;
  margin-top: 5px;
  font-style: italic;
  line-height: 1.4;
}

/* Buttons */
button {
  background: linear-gradient(135deg, #FF0000 0%, #cc0000 100%);
  color: white;
  border: none;
  padding: 16px 32px;
  border-radius: 10px;
  font-size: 1.1rem;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.3s ease;
  margin-top: 25px;
  display: inline-flex;
  align-items: center;
  gap: 10px;
  text-transform: uppercase;
  letter-spacing: 1px;
  box-shadow: 0 4px 15px rgba(255, 0, 0, 0.3);
  position: relative;
  overflow: hidden;
  width: 100%;
  justify-content: center;
}

button:hover {
  background: linear-gradient(135deg, #ff1a1a 0%, #e60000 100%);
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(255, 0, 0, 0.4);
}

button:active {
  transform: translateY(-1px);
  box-shadow: 0 4px 15px rgba(255, 0, 0, 0.3);
}

/* Small buttons */
button.small {
  padding: 8px 16px;
  font-size: 0.9rem;
  margin: 5px;
  width: auto;
}

/* Results */
.result {
  margin-top: 1.5rem;
  padding: 25px;
  background: linear-gradient(135deg, rgba(0, 0, 0, 0.6) 0%, rgba(0, 0, 0, 0.8) 100%);
  border: 2px solid rgba(255, 255, 255, 0.1);
  border-radius: 14px;
  transition: all 0.4s ease;
  position: relative;
  overflow: hidden;
  font-weight: 600;
  min-height: 60px;
  display: flex;
  align-items: center;
}

.result.success {
  border-color: rgba(46, 125, 50, 0.7);
  background: linear-gradient(135deg, rgba(46, 125, 50, 0.15) 0%, rgba(46, 125, 50, 0.08) 100%);
  color: #a5d6a7;
}

.result.warning {
  border-color: rgba(245, 124, 0, 0.7);
  background: linear-gradient(135deg, rgba(245, 124, 0, 0.15) 0%, rgba(245, 124, 0, 0.08) 100%);
  color: #ffcc80;
}

.result.danger {
  border-color: rgba(211, 47, 47, 0.7);
  background: linear-gradient(135deg, rgba(211, 47, 47, 0.15) 0%, rgba(211, 47, 47, 0.08) 100%);
  color: #ef9a9a;
}

/* Feedback Results */
.feedback-results {
  width: 100%;
}

.main-recommendation {
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.main-recommendation h4 {
  color: #FF0000;
  font-size: 1.2rem;
  margin-bottom: 10px;
}

.advice {
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 8px;
}

.sets-info {
  font-size: 1rem;
  color: #ccc;
}

.algorithm-details {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 15px;
}

.algorithm-details > div {
  padding: 10px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 8px;
  font-size: 0.9rem;
}

.stimulus-add_sets { color: #4CAF50; }
.stimulus-maintain { color: #ffcc80; }
.stimulus-reduce_sets { color: #ff9800; }

.rir-feedback {
  margin-top: 15px;
  padding: 12px;
  border-radius: 8px;
  font-size: 0.95rem;
}

.rir-feedback.normal { background: rgba(76, 175, 80, 0.2); }
.rir-feedback.medium { background: rgba(255, 152, 0, 0.2); }
.rir-feedback.high { background: rgba(244, 67, 54, 0.2); }

.deload-warning {
  margin-top: 15px;
  padding: 15px;
  background: rgba(255, 152, 0, 0.2);
  border: 1px solid rgba(255, 152, 0, 0.5);
  border-radius: 8px;
  font-weight: 600;
}

/* Advanced Volume Controls */
.advanced-volume-controls {
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  padding-top: 20px;
}

.landmark-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 15px;
  margin-bottom: 20px;
}

/* Autoregulation Section */
.autoregulation-section {
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  padding-top: 20px;
  margin-top: 20px;
}

.autoregulation-section h4 {
  color: #FF0000;
  font-size: 1.2rem;
  margin-bottom: 15px;
}

/* Tooltips */
.rir-tooltip {
  font-size: 12px;
  font-weight: 600;
  pointer-events: none;
}

/* RIR Schedule & Load Feedback Styling */
.rir-schedule-display,
.load-feedback-section,
.load-progression-section {
  margin-top: 20px;
  padding-top: 15px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.rir-schedule-display h4,
.load-feedback-section h4,
.load-progression-section h4 {
  color: #FF0000;
  font-size: 1.1rem;
  margin-bottom: 12px;
  font-weight: 600;
}

#rirScheduleContent {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 10px;
  margin: 15px 0;
}

.rir-week-target {
  padding: 12px;
  background: rgba(255, 0, 0, 0.1);
  border: 1px solid rgba(255, 0, 0, 0.3);
  border-radius: 8px;
  text-align: center;
  font-weight: 600;
}

.rir-week-target.current {
  background: rgba(255, 0, 0, 0.2);
  border-color: rgba(255, 0, 0, 0.5);
  box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
}

.rir-week-target .week-label {
  font-size: 0.9rem;
  color: #ccc;
  margin-bottom: 4px;
}

.rir-week-target .rir-value {
  font-size: 1.4rem;
  color: #FF0000;
  font-weight: 700;
}

#loadAdjustmentContent,
#loadProgressionContent {
  font-size: 0.95rem;
}

.load-adjustment-item {
  padding: 10px;
  margin: 8px 0;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 6px;
  border-left: 3px solid #FF0000;
}

.load-adjustment-item .muscle-name {
  font-weight: 600;
  color: #FF0000;
  margin-bottom: 4px;
}

.load-adjustment-item .adjustment-details {
  color: #ccc;
  font-size: 0.9rem;
}

.progression-recommendation {
  padding: 15px;
  background: rgba(76, 175, 80, 0.1);
  border: 1px solid rgba(76, 175, 80, 0.3);
  border-radius: 8px;
  margin: 10px 0;
}

.progression-recommendation.maintain {
  background: rgba(255, 193, 7, 0.1);
  border-color: rgba(255, 193, 7, 0.3);
}

.progression-recommendation.reduce {
  background: rgba(244, 67, 54, 0.1);
  border-color: rgba(244, 67, 54, 0.3);
}

.progression-recommendation .action {
  font-weight: 600;
  font-size: 1.1rem;
  margin-bottom: 8px;
}

.progression-recommendation .reasoning {
  font-size: 0.9rem;
  color: #ccc;
  line-height: 1.4;
}

.rir-schedule-info {
  margin-top: 20px;
  padding: 15px;
  background: rgba(255, 255, 255, 0.03);
  border-radius: 8px;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.rir-schedule-info .helper-text {
  font-size: 0.9rem;
  line-height: 1.5;
}

/* RIR Schedule buttons */
.rir-schedule-display button,
.load-feedback-section button,
.load-progression-section button {
  background: linear-gradient(135deg, #FF0000 0%, #cc0000 100%);
  margin: 5px 0;
  width: auto;
  min-width: 180px;
}

/* --- Advanced Intelligence Section --- */
.section-banner.advanced {
  background: linear-gradient(135deg, rgba(0, 123, 255, 0.2) 0%, rgba(0, 123, 255, 0.1) 100%);
  border-color: rgba(0, 123, 255, 0.3);
}

.section-content#advanced-content {
  display: none;
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.4s ease;
}

.section-content#advanced-content.expanded {
  display: block;
  max-height: 3000px;
}

.live-session-controls {
  margin-bottom: 20px;
}

.session-controls {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  margin-top: 15px;
}

.session-controls button {
  flex: 1;
  min-width: 140px;
  margin: 0;
}

.live-monitor {
  background: #1a202c;
  color: #e2e8f0;
  border-radius: 15px;
  padding: 25px;
  margin: 20px 0;
  border: 1px solid rgba(99, 179, 237, 0.3);
}

.live-monitor h4 {
  color: #63b3ed;
  margin-bottom: 20px;
  font-size: 1.1rem;
}

.monitor-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 15px;
}

.monitor-stat {
  background: rgba(255, 255, 255, 0.05);
  padding: 15px;
  border-radius: 10px;
  text-align: center;
}

.monitor-stat .value {
  font-size: 2em;
  font-weight: bold;
  color: #63b3ed;
  display: block;
}

.monitor-stat .label {
  font-size: 0.9em;
  opacity: 0.8;
  margin-top: 5px;
}

.intelligence-panel {
  background: linear-gradient(135deg, #1a365d, #2c5282);
  color: white;
  border-radius: 15px;
  padding: 25px;
  margin: 20px 0;
}

.intelligence-panel h4 {
  color: #63b3ed;
  margin-bottom: 20px;
}

.intelligence-controls,
.analytics-controls {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 10px;
  margin: 15px 0;
}

.intelligence-controls button,
.analytics-controls button {
  margin: 0;
  padding: 12px 16px;
  font-size: 0.95rem;
}

.system-status {
  margin-top: 20px;
  padding: 15px;
  background: rgba(255, 255, 255, 0.02);
  border-radius: 10px;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.system-status h4 {
  color: #FF0000;
  margin-bottom: 15px;
}

.system-status .status-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 10px;
}

.system-status .status-indicator {
  text-align: center;
  padding: 10px;
  background: rgba(255, 255, 255, 0.03);
  border-radius: 8px;
}

.system-status .status-indicator span:first-child {
  font-size: 1.5em;
  display: block;
}

.system-status .status-indicator span:last-child {
  font-size: 0.8em;
  color: #ccc;
  margin-top: 5px;
  display: block;
}

.recommendation {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 8px;
  padding: 15px;
  margin: 10px 0;
  border-left: 4px solid #63b3ed;
}

.recommendation.high-priority {
  border-left-color: #f56565;
  background: rgba(245, 101, 101, 0.1);
}

.recommendation.medium-priority {
  border-left-color: #ed8936;
  background: rgba(237, 137, 54, 0.1);
}

.analytics-requirements {
  margin: 15px 0;
  padding: 15px;
  background: rgba(255, 193, 7, 0.1);
  border: 1px solid rgba(255, 193, 7, 0.3);
  border-radius: 8px;
}

.program-config {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin: 20px 0;
}

.program-config .input-group {
  margin: 0;
}

/* Advanced result panels */
.result-panel {
  margin-top: 15px;
  padding: 20px;
  border-radius: 10px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  font-size: 0.95rem;
  line-height: 1.5;
}

.result-panel.success {
  background: rgba(76, 175, 80, 0.1);
  border-color: rgba(76, 175, 80, 0.3);
}

.result-panel.warning {
  background: rgba(255, 152, 0, 0.1);
  border-color: rgba(255, 152, 0, 0.3);
}

.result-panel.error {
  background: rgba(244, 67, 54, 0.1);
  border-color: rgba(244, 67, 54, 0.3);
}

.loading {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 2px solid #f3f3f3;
  border-radius: 50%;
  border-top-color: #5a67d8;
  animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* --- Utility Systems Styling --- */
/* Performance Monitor Styles */
.performance-controls {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 10px;
  margin: 15px 0;
}

.performance-dashboard {
  background: rgba(0, 123, 255, 0.1);
  border: 1px solid rgba(0, 123, 255, 0.3);
  border-radius: 12px;
  padding: 20px;
  margin: 20px 0;
}

.metrics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 15px;
  margin-top: 15px;
}

.metric-card {
  background: rgba(255, 255, 255, 0.05);
  padding: 15px;
  border-radius: 8px;
  text-align: center;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.metric-value {
  font-size: 1.8rem;
  font-weight: 700;
  color: #63b3ed;
  display: block;
}

.metric-label {
  font-size: 0.8rem;
  color: #ccc;
  margin-top: 5px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* Data Export Styles */
.export-controls {
  margin: 20px 0;
}

.export-options {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 10px;
  margin: 15px 0;
  padding: 15px;
  background: rgba(255, 255, 255, 0.03);
  border-radius: 8px;
}

.checkbox-label {
  display: flex !important;
  align-items: center;
  gap: 8px;
  font-size: 0.9rem !important;
  font-weight: 500 !important;
  text-transform: none !important;
  letter-spacing: normal !important;
  margin: 0 !important;
  cursor: pointer;
}

.export-actions {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 10px;
  margin: 15px 0;
}

.export-actions button {
  margin: 0 !important;
  width: auto !important;
}

/* Feedback System Styles */
.feedback-controls {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 10px;
  margin: 15px 0;
}

.feedback-stats {
  background: rgba(76, 175, 80, 0.1);
  border: 1px solid rgba(76, 175, 80, 0.3);
  border-radius: 12px;
  padding: 20px;
  margin: 20px 0;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 15px;
  margin-top: 15px;
}

.stat-item {
  background: rgba(255, 255, 255, 0.05);
  padding: 15px;
  border-radius: 8px;
  text-align: center;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.stat-value {
  font-size: 1.8rem;
  font-weight: 700;
  color: #4CAF50;
  display: block;
}

.stat-label {
  font-size: 0.8rem;
  color: #ccc;
  margin-top: 5px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* Feedback Widget */
.feedback-widget {
  position: fixed;
  top: 50%;
  right: 20px;
  transform: translateY(-50%);
  z-index: 1000;
}

.feedback-toggle {
  background: linear-gradient(135deg, #FF0000 0%, #cc0000 100%);
  color: white;
  padding: 10px 15px;
  border-radius: 20px 0 0 20px;
  cursor: pointer;
  font-size: 0.9rem;
  font-weight: 600;
  box-shadow: -3px 0 10px rgba(0, 0, 0, 0.3);
  transition: all 0.3s ease;
}

.feedback-toggle:hover {
  background: linear-gradient(135deg, #ff1a1a 0%, #e60000 100%);
  transform: translateX(-5px);
}

.feedback-panel {
  position: absolute;
  right: 100%;
  top: 0;
  width: 320px;
  background: rgba(26, 26, 26, 0.95);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 0, 0, 0.3);
  border-radius: 12px;
  padding: 20px;
  box-shadow: -5px 0 20px rgba(0, 0, 0, 0.5);
}

.feedback-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.feedback-header h3 {
  color: #FF0000;
  font-size: 1.1rem;
  margin: 0;
}

.feedback-header button {
  background: none;
  border: none;
  color: #ccc;
  font-size: 1.5rem;
  cursor: pointer;
  padding: 0;
  margin: 0;
  width: auto;
  height: auto;
}

/* --- End of Styles --- */
</style>

<div class="container">
  <header class="header-section">
    <h1>PowerHouseATX</h1>
    <div class="page-title">Workout Calculator</div>
    <p class="subtitle">Evidence-Based Muscle Building</p>
    
    <!-- Quick Start Guide -->
    <div class="quick-start-guide" id="quickStartGuide">
      <h3>üöÄ First-Time Quick-Start Guide</h3>
      <div class="quick-start-content">
        <ol class="quick-start-steps">
          <li><strong>Set volume landmarks</strong> ‚Üí open "Program Setup" section below</li>
          <li><strong>Track daily volume</strong> ‚Üí use "Daily Volume" for each muscle group</li>
          <li><strong>Log a workout</strong> ‚Üí use "Set Feedback" after each exercise</li>
          <li><strong>End of week</strong> ‚Üí tick "Last workout" & review Weekly analysis</li>
          <li><strong>Start next week</strong> ‚Üí follow the new RIR target</li>
        </ol>        <div class="quick-start-actions">
          <button class="quick-start-btn" onclick="document.getElementById('quickStartGuide').style.display = 'none'; return false;" style="cursor: pointer; font-weight: bold;">GOT IT, HIDE THIS GUIDE</button>
          <label class="quick-start-checkbox">
            <input type="checkbox" id="dontShowQuickStart"> Don't show again
          </label>
        </div>
      </div>
    </div>
    
    <!-- RP Training Status -->
    <div class="rp-status">
      <h3>Current Training Status</h3>
      <div class="status-grid">
        <div class="status-item">
          <div class="status-value" id="currentWeek">1</div>
          <div class="status-label">Week</div>
        </div>
        <div class="status-item">
          <div class="status-value" id="currentMeso">4</div>
          <div class="status-label">Meso Length</div>
        </div>
        <div class="status-item">
          <div class="status-value" id="currentBlock">1</div>
          <div class="status-label">Block</div>
        </div>
        <div class="status-item">
          <div class="status-value" id="targetRIR">4.5</div>
          <div class="status-label">Target RIR</div>
        </div>
        <div class="status-item">
          <div class="status-value" id="currentPhase">Accumulation</div>
          <div class="status-label">Phase</div>
        </div>
      </div>
    </div>
  </header>

  <!-- Weekly Volume Chart -->
  <div class="chart-section">    <div class="chart-header">
      <h2>Weekly Volume by Muscle</h2>
      <div class="chart-controls">
        <button class="small" onclick="resetWeeklyData()">Reset Week</button>
        <button class="small" onclick="exportSummary()">üìä Export Chart</button>
      </div>
    </div>
    <canvas id="weeklyChart"></canvas>
  </div>  <div class="section-banner" onclick="toggleSection('daily')">
    <h3>Daily Training <span class="expand-icon">‚ñº</span></h3>
    <p>Use during or right after your workout</p>
  </div>

  <div class="section-content" id="daily-content">
    <div class="calculator-grid">
      
      <!-- Set Feedback with RP Algorithms -->
      <section class="calculator" id="mevCard">
        <h2>Set Feedback (RP Algorithms)</h2>
        
        <div class="input-group">
          <label for="muscleSelect">Muscle group:</label>
          <select id="muscleSelect">
            <option value="Chest">Chest</option>
            <option value="Back">Back</option>
            <option value="Quads">Quads</option>
            <option value="Hamstrings">Hamstrings</option>
            <option value="Shoulders">Shoulders</option>
            <option value="Biceps">Biceps</option>
            <option value="Triceps">Triceps</option>
            <option value="Calves">Calves</option>
            <option value="Abs">Abs</option>
            <option value="Forearms">Forearms</option>
            <option value="Neck">Neck</option>
            <option value="Traps">Traps</option>
          </select>
        </div>

        <div class="input-group">
          <label for="currentSets">Current weekly sets:</label>
          <input type="number" id="currentSets" min="0" value="0">
          <div class="helper-text">Click to edit inline</div>
        </div>

        <div class="input-group">
          <label>Workload (RP Table 2.2):</label>
          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
            <div>
              <label for="mmc" style="font-size: 0.8rem;">Mind-Muscle (0-3):</label>
              <input type="number" id="mmc" min="0" max="3" value="2">
            </div>
            <div>
              <label for="pump" style="font-size: 0.8rem;">Pump (0-3):</label>
              <input type="number" id="pump" min="0" max="3" value="2">
            </div>
            <div>              <label for="dis" style="font-size: 0.8rem;">Workload (0-3):</label>
              <input type="number" id="dis" min="0" max="3" value="2">
            </div>
          </div>
          <div class="helper-text">Rate your workout quality factors (0=poor, 3=excellent)</div>
        </div>

        <div class="input-group">
          <label>Performance vs last time:</label>
          <div class="radio-group">
            <label><input type="radio" name="perf" value="3"> Much Better</label>
            <label><input type="radio" name="perf" value="2" checked> Better</label>
            <label><input type="radio" name="perf" value="1"> Same</label>
            <label><input type="radio" name="perf" value="0"> Worse</label>
          </div>
        </div>

        <div class="input-group">
          <label for="sore">Current soreness level (0-3):</label>
          <input type="number" id="sore" min="0" max="3" value="1">
          <div class="helper-text">0=None, 1=Mild, 2=Moderate, 3=High</div>
        </div>

        <!-- Enhanced Fatigue Detection -->
        <div class="input-group">
          <label for="jointAche">Joint ache level (0-3):</label>
          <input type="number" id="jointAche" min="0" max="3" value="0">
          <div class="helper-text">0=None, 1=Mild, 2=Moderate, 3=Pain</div>
        </div>

        <div class="input-group">
          <label for="perfChange">Performance change:</label>
          <select id="perfChange">
            <option value="1">Personal Record (+1)</option>
            <option value="0" selected>Same as last time (0)</option>
            <option value="-1">Performance drop (-1)</option>
          </select>
          <div class="helper-text">Strength performance vs recent sessions</div>
        </div>

        <!-- Autoregulation Section -->
        <div class="autoregulation-section">
          <h4>Effort Validation</h4>
          <div class="input-group">
            <label for="actualRIR">Actual RIR this set:</label>
            <input type="number" id="actualRIR" min="0" max="10" step="0.5" placeholder="e.g. 2.5">
            <div class="helper-text">How many more reps could you have done? (Target: <span id="targetRIRDisplay">4.5</span>)</div>
          </div>
        </div>

        <button onclick="submitFeedback()">Process with RP Algorithms</button>
        <output id="mevOut" class="result"></output>
      </section>

    </div>
  </div>

  <div class="section-banner" onclick="toggleSection('weekly')">
    <h3>Weekly Planning <span class="expand-icon">‚ñº</span></h3>
    <p>End-of-week review and next week setup</p>
  </div>

  <div class="section-content" id="weekly-content">
    <div class="calculator-grid">

      <!-- Deload Check -->
      <section class="calculator" id="deloadCard">
        <h2>Deload Analysis</h2>
        
        <div class="input-group">
          <label>
            <input type="checkbox" id="halfMuscles"> Most muscles needed recovery (‚â•6 muscle groups)
          </label>
        </div>
        
        <div class="input-group">
          <label>
            <input type="checkbox" id="mrvBreach"> Hit MRV twice in a row
          </label>
        </div>
        
        <div class="input-group">
          <label>
            <input type="checkbox" id="illness"> Illness / Minor Injury
          </label>
        </div>

        <div class="input-group">
          <label>
            <input type="checkbox" id="lowMotivation"> Low motivation/enjoyment
          </label>
        </div>
        
        <button onclick="analyzeDeload()">Analyze Deload Need</button>
        <output id="deloadOut" class="result"></output>
      </section>

      <!-- Auto-Volume Progression -->
      <section class="calculator" id="autoVolumeCard">
        <h2>ü§ñ Auto-Volume Progression</h2>
        
        <div class="input-group">
          <p class="helper-text">Automatically progress all muscles based on weekly feedback. System starts each muscle at MEV and adds +1-2 sets per week based on recovery indicators.</p>
        </div>
          <div class="input-group">
          <h4>Progression Logic:</h4>
          <ul style="font-size: 0.9rem; margin: 10px 0; padding-left: 20px;">
            <li><strong>Start:</strong> All muscles begin at MEV</li>
            <li><strong>+1 set:</strong> Good recovery (soreness ‚â§1, performance ‚â•0)</li>
            <li><strong>+2 sets:</strong> At MEV or low stimulus (‚â§3)</li>
            <li><strong>Hold volume:</strong> At MRV or fatigue present</li>
            <li><strong>Deload:</strong> Most muscles at MRV</li>
          </ul>
        </div>
          <div class="input-group" style="display: flex; gap: 10px; flex-wrap: wrap;">
          <button type="button" class="small" onclick="initializeAllMusclesAtMEV()" style="background: linear-gradient(135deg, #4CAF50, #45a049); flex: 1; min-width: 150px;">üéØ Initialize at MEV</button>
          <button type="button" class="small" onclick="advanceToNextWeek()" style="background: linear-gradient(135deg, #2196F3, #1976D2); flex: 1; min-width: 150px;">üìÖ Next Week</button>
          <button onclick="runAutoVolumeProgression()" style="background: linear-gradient(135deg, #ff4444, #ff6666); font-weight: bold; flex: 2; min-width: 200px;">‚ñ∂Ô∏è Run Weekly Auto-Progression</button>
        </div>
        <output id="autoVolumeOut" class="result"></o>
      </section>

      <!-- Frequency Optimization -->
      <section class="calculator" id="freqCard">
        <h2>Frequency Optimization</h2>
        
        <div class="input-group">
          <label for="soreDays">Days until soreness gone:</label>
          <input type="number" id="soreDays" min="0" value="2">
        </div>
        
        <div class="input-group">
          <label for="sessionGap">Current session gap (days):</label>
          <input type="number" id="sessionGap" min="1" value="3">
        </div>
        
        <div class="input-group">
          <label for="trainingAge">Training experience:</label>
          <select id="trainingAge">
            <option value="beginner">Beginner (< 1 year)</option>
            <option value="intermediate" selected>Intermediate (1-3 years)</option>
            <option value="advanced">Advanced (> 3 years)</option>
          </select>
        </div>
        
        <button onclick="analyzeFrequency()">Optimize Frequency</button>
        <output id="freqOut" class="result"></output>
      </section>

    </div>
  </div>

  <div class="section-banner" onclick="toggleSection('setup')">
    <h3>Program Setup <span class="expand-icon">‚ñº</span></h3>
    <p>Configure volume landmarks and training blocks</p>
  </div>

  <div class="section-content" id="setup-content">
    <div class="calculator-grid">

      <!-- Volume Landmarks Setup -->
      <section class="calculator" id="volumeCard">
        <h2>Volume Landmarks (RP Method)</h2>
        
        <div class="input-group">
          <label for="landmarkMuscle">Muscle to configure:</label>
          <select id="landmarkMuscle">
            <option value="Chest">Chest</option>
            <option value="Back">Back</option>
            <option value="Quads">Quads</option>
            <option value="Hamstrings">Hamstrings</option>
            <option value="Shoulders">Shoulders</option>
            <option value="Biceps">Biceps</option>
            <option value="Triceps">Triceps</option>
            <option value="Calves">Calves</option>
            <option value="Abs">Abs</option>
            <option value="Forearms">Forearms</option>
            <option value="Neck">Neck</option>
            <option value="Traps">Traps</option>
          </select>
        </div>

        <div class="landmark-grid">
          <div class="input-group">
            <label for="mv">MV (Maintenance Volume):</label>
            <input type="number" id="mv" min="0" value="4">
            <div class="helper-text">Minimum to maintain muscle</div>
          </div>
          
          <div class="input-group">
            <label for="mev">MEV (Minimum Effective):</label>
            <input type="number" id="mev" min="0" value="8">
            <div class="helper-text">Minimum for growth</div>
          </div>
          
          <div class="input-group">
            <label for="mav">MAV (Maximum Adaptive):</label>
            <input type="number" id="mav" min="0" value="16">
            <div class="helper-text">Best volume for adaptation</div>
          </div>
          
          <div class="input-group">
            <label for="mrv">MRV (Maximum Recoverable):</label>
            <input type="number" id="mrv" min="0" value="22">
            <div class="helper-text">Maximum you can recover from</div>
          </div>
        </div>

        <div class="input-group">
          <button type="button" class="small" onclick="applyVolumePreset('beginner')">Beginner Preset</button>
          <button type="button" class="small" onclick="applyVolumePreset('intermediate')">Intermediate Preset</button>
          <button type="button" class="small" onclick="applyVolumePreset('advanced')">Advanced Preset</button>
        </div>
        
        <button onclick="saveLandmarks()">Save Volume Landmarks</button>
        <output id="volumeOut" class="result"></output>

        <!-- Volume Status Display -->
        <div id="volumeStatus" class="volume-status"></div>
      </section>

      <!-- Mesocycle Setup -->
      <section class="calculator" id="mesoCard">
        <h2>Mesocycle Setup</h2>
        
        <div class="input-group">
          <label for="mesoLength">Mesocycle length (weeks):</label>
          <input type="number" id="mesoLength" min="2" max="8" value="4">
          <div class="helper-text">Typical range: 3-6 weeks</div>
        </div>
        
        <div class="input-group">
          <label for="currentWeekNum">Current week number:</label>
          <input type="number" id="currentWeekNum" min="1" value="1">
        </div>

        <div class="input-group">
          <label for="trainingGoal">Primary goal:</label>
          <select id="trainingGoal">
            <option value="hypertrophy" selected>Hypertrophy</option>
            <option value="strength">Strength</option>
            <option value="power">Power</option>
            <option value="endurance">Endurance</option>
          </select>
        </div>
        
        <button onclick="setupMeso()">Setup Mesocycle</button>
        <output id="mesoOut" class="result"></output>
      </section>

      <!-- RIR Schedule & Load Feedback -->
      <section class="calculator" id="rirScheduleCard">
        <h2>RIR Schedule & Load Feedback</h2>
        
        <div class="input-group">
          <label for="rirMesocycleLength">Mesocycle length (weeks):</label>
          <input type="number" id="rirMesocycleLength" min="3" max="6" value="4">
          <div class="helper-text">Standard progression: 4-6 weeks</div>
        </div>
        
        <div class="input-group">
          <label for="rirCurrentWeek">Current week:</label>
          <input type="number" id="rirCurrentWeek" min="1" max="6" value="1">
        </div>

        <div class="rir-schedule-display">
          <button onclick="showRIRSchedule()" class="small">Show RIR Schedule</button>
          <div id="rirScheduleDisplay" class="result" style="display: none;">
            <h4>Weekly RIR Targets</h4>
            <div id="rirScheduleContent"></div>
          </div>
        </div>

        <div class="load-feedback-section">
          <h4>Weekly Load Adjustments</h4>
          <div class="input-group">
            <label>
              <input type="checkbox" id="simulateRIRFeedback" checked>
              Use simulated RIR feedback for demo
            </label>
            <div class="helper-text">Uncheck to manually input RIR values</div>
          </div>
          
          <button onclick="runWeeklyLoadAdjustments()" class="small">Process Weekly Adjustments</button>
          <div id="loadAdjustmentResults" class="result" style="display: none;">
            <div class="feedback-results">
              <div id="loadAdjustmentContent"></div>
            </div>
          </div>
        </div>

        <div class="load-progression-section">
          <h4>Next Week Progression</h4>
          <button onclick="showNextWeekLoadProgression()" class="small">Show Load Progression</button>
          <div id="loadProgressionResults" class="result" style="display: none;">
            <div class="feedback-results">
              <div id="loadProgressionContent"></div>
            </div>
          </div>
        </div>

        <div class="rir-schedule-info">
          <div class="helper-text">
            <strong>RIR Schedule System:</strong><br>
            ‚Ä¢ Automatically progresses RIR targets weekly: [3, 2, 1, 0]<br>
            ‚Ä¢ Processes feedback to adjust training loads (-15% to +15%)<br>
            ‚Ä¢ Provides next week progression recommendations<br>
            ‚Ä¢ Integrates with auto-progression system
          </div>
        </div>
      </section>

    </div>
  </div>

  <!-- Advanced Intelligence Section -->
  <div class="section-banner advanced" onclick="toggleSection('advanced')">
    <h3>Advanced Intelligence <span class="expand-icon">‚ñº</span></h3>
    <p>AI-powered training optimization and live performance monitoring</p>
  </div>

  <div class="section-content" id="advanced-content">
    <div class="calculator-grid">

      <!-- Live Performance Monitor -->
      <section class="calculator" id="liveMonitorCard">
        <h2>üî¥ Live Performance Monitor</h2>
        
        <div class="input-group">
          <p class="helper-text">Real-time feedback during training sessions with automatic performance analysis and next-set recommendations.</p>
        </div>

        <div class="live-session-controls">
          <div class="input-group">
            <label for="liveExercise">Exercise:</label>
            <input type="text" id="liveExercise" placeholder="e.g. Barbell Bench Press" value="Barbell Bench Press">
          </div>

          <div class="input-group">
            <label for="liveMuscle">Primary Muscle:</label>
            <select id="liveMuscle">
              <option value="Chest">Chest</option>
              <option value="Back">Back</option>
              <option value="Quads">Quads</option>
              <option value="Hamstrings">Hamstrings</option>
              <option value="Shoulders">Shoulders</option>
              <option value="Biceps">Biceps</option>
              <option value="Triceps">Triceps</option>
            </select>
          </div>

          <div class="input-group">
            <label for="plannedSets">Planned Sets:</label>
            <input type="number" id="plannedSets" min="1" max="10" value="3">
          </div>

          <div class="session-controls">
            <button id="startSessionBtn" onclick="startLiveSession()">üéÆ Start Live Session</button>
            <button id="logSetBtn" onclick="logTrainingSet()" style="display: none;">üìä Log Set</button>
            <button id="endSessionBtn" onclick="endLiveSession()" style="display: none;">‚èπÔ∏è End Session</button>
          </div>
        </div>

        <!-- Live Monitor Dashboard -->
        <div class="live-monitor" id="liveMonitor" style="display: none;">
          <h4>üî¥ Live Training Monitor</h4>
          <div class="monitor-grid">
            <div class="monitor-stat">
              <div class="value" id="currentSet">0</div>
              <div class="label">Current Set</div>
            </div>
            <div class="monitor-stat">
              <div class="value" id="currentRIR">-</div>
              <div class="label">Last RIR</div>
            </div>
            <div class="monitor-stat">
              <div class="value" id="sessionProgress">0%</div>
              <div class="label">Progress</div>
            </div>
            <div class="monitor-stat">
              <div class="value" id="totalLoad">0</div>
              <div class="label">Total Load</div>
            </div>
          </div>
        </div>

        <output id="liveMonitorOut" class="result"></output>
      </section>

      <!-- AI Training Intelligence -->
      <section class="calculator" id="trainingIntelligenceCard">
        <h2>üß† Training Intelligence Hub</h2>
        
        <div class="input-group">
          <p class="helper-text">Unified intelligence system that coordinates machine learning analytics, smart exercise selection, and performance optimization.</p>
        </div>

        <div class="intelligence-controls">
          <button onclick="initializeIntelligence()">üöÄ Initialize Intelligence</button>
          <button onclick="getWeeklyIntelligence()">üìà Weekly Intelligence Report</button>
          <button onclick="getOptimalExercises()">üí° Smart Exercise Selection</button>
          <button onclick="assessTrainingRisk()">‚ö†Ô∏è Risk Assessment</button>
        </div>

        <!-- Intelligence Dashboard -->
        <div class="intelligence-panel" id="intelligencePanel" style="display: none;">
          <h4>üéØ Training Intelligence Dashboard</h4>
          <div id="intelligenceContent"></div>
        </div>

        <!-- System Status -->
        <div class="system-status">
          <h4>‚öôÔ∏è System Status</h4>
          <div class="status-grid">
            <div class="status-indicator">
              <span id="analyticsStatus">‚ùå</span>
              <span>Analytics</span>
            </div>
            <div class="status-indicator">
              <span id="exerciseStatus">‚úÖ</span>
              <span>Exercise AI</span>
            </div>
            <div class="status-indicator">
              <span id="liveStatus">‚úÖ</span>
              <span>Live Monitor</span>
            </div>
            <div class="status-indicator">
              <span id="hubStatus">‚úÖ</span>
              <span>Intelligence Hub</span>
            </div>
          </div>
        </div>

        <output id="intelligenceOut" class="result"></output>
      </section>

      <!-- Predictive Analytics -->
      <section class="calculator" id="analyticsCard">
        <h2>üìä Predictive Analytics</h2>
        
        <div class="input-group">
          <p class="helper-text">Machine learning powered insights for volume optimization, deload prediction, and plateau detection.</p>
        </div>

        <div class="analytics-controls">
          <button onclick="optimizeVolumeLandmarks()">üéØ Optimize Volume Landmarks</button>
          <button onclick="predictDeloadTiming()">üîÆ Predict Deload Timing</button>
          <button onclick="detectPlateaus()">üìà Plateau Analysis</button>
          <button onclick="getAdaptiveRIR()">üéõÔ∏è Adaptive RIR Recommendations</button>
        </div>

        <div class="analytics-requirements" id="analyticsRequirements">
          <div class="helper-text">
            <strong>üìä Analytics Requirements:</strong><br>
            ‚Ä¢ Minimum 4 weeks of training data needed<br>
            ‚Ä¢ System learns from your session feedback<br>
            ‚Ä¢ More data = Better predictions<br>
            ‚Ä¢ Auto-enabled when sufficient data available
          </div>
        </div>

        <output id="analyticsOut" class="result"></output>
      </section>

      <!-- Smart Program Generator -->
      <section class="calculator" id="programGeneratorCard">
        <h2>üèãÔ∏è Smart Program Generator</h2>
        
        <div class="input-group">
          <p class="helper-text">AI-powered weekly program generation based on your preferences, equipment, and current fatigue levels.</p>
        </div>

        <div class="program-config">
          <div class="input-group">
            <label for="programDays">Days per week:</label>
            <select id="programDays">
              <option value="3">3 Days</option>
              <option value="4" selected>4 Days</option>
              <option value="5">5 Days</option>
              <option value="6">6 Days</option>
            </select>
          </div>

          <div class="input-group">
            <label for="programSplit">Split Type:</label>
            <select id="programSplit">
              <option value="upper_lower" selected>Upper/Lower</option>
              <option value="push_pull_legs">Push/Pull/Legs</option>
              <option value="full_body">Full Body</option>
              <option value="bro_split">Bro Split</option>
            </select>
          </div>

          <div class="input-group">
            <label for="sessionTime">Session Duration:</label>
            <select id="sessionTime">
              <option value="45">45 minutes</option>
              <option value="60" selected>60 minutes</option>
              <option value="75">75 minutes</option>
              <option value="90">90 minutes</option>
            </select>
          </div>

          <div class="input-group">
            <label for="experienceLevel">Experience Level:</label>
            <select id="experienceLevel">
              <option value="beginner">Beginner</option>
              <option value="intermediate" selected>Intermediate</option>
              <option value="advanced">Advanced</option>
            </select>
          </div>
        </div>

        <button onclick="generateWeeklyProgram()">üìã Generate Weekly Program</button>
        <output id="programOut" class="result"></output>
      </section>

      <!-- Performance Monitor & Analytics -->
      <section class="calculator" id="performanceCard">
        <h2>‚ö° Performance Monitor</h2>
        
        <div class="input-group">
          <p class="helper-text">Real-time performance monitoring, optimization analytics, and system health tracking for optimal app performance.</p>
        </div>

        <div class="performance-controls">
          <button onclick="performanceManager.initialize()">üöÄ Initialize Monitoring</button>
          <button onclick="performanceManager.generateReport()">üìä Performance Report</button>
          <button onclick="performanceManager.optimizeApp()">‚öôÔ∏è Optimize App</button>
          <button onclick="performanceManager.clearCache()">üßπ Clear Cache</button>
        </div>

        <!-- Performance Dashboard -->
        <div class="performance-dashboard" id="performanceDashboard" style="display: none;">
          <h4>üìà Performance Metrics</h4>
          <div class="metrics-grid">
            <div class="metric-card">
              <div class="metric-value" id="loadTime">-</div>
              <div class="metric-label">Load Time (ms)</div>
            </div>
            <div class="metric-card">
              <div class="metric-value" id="memoryUsage">-</div>
              <div class="metric-label">Memory (MB)</div>
            </div>
            <div class="metric-card">
              <div class="metric-value" id="renderTime">-</div>
              <div class="metric-label">Render Time (ms)</div>
            </div>
            <div class="metric-card">
              <div class="metric-value" id="fps">-</div>
              <div class="metric-label">FPS</div>
            </div>
          </div>
        </div>

        <output id="performanceOut" class="result"></output>
      </section>

      <!-- Data Export & Backup -->
      <section class="calculator" id="dataExportCard">
        <h2>üíæ Data Export & Backup</h2>
        
        <div class="input-group">
          <p class="helper-text">Export your training data, create backups, and manage data in multiple formats for analysis and portability.</p>
        </div>

        <div class="export-controls">
          <div class="input-group">
            <label for="exportFormat">Export Format:</label>
            <select id="exportFormat">
              <option value="json" selected>JSON (Complete)</option>
              <option value="csv">CSV (Spreadsheet)</option>
              <option value="excel">Excel (Advanced)</option>
            </select>
          </div>

          <div class="export-options">
            <label class="checkbox-label">
              <input type="checkbox" id="includePersonal" checked>
              Include Personal Data
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="includeAnalytics" checked>
              Include Analytics
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="includeWellness" checked>
              Include Wellness Data
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="compressData" checked>
              Compress Data
            </label>
          </div>

          <div class="export-actions">
            <button onclick="dataExportManager.exportAllData()">üì§ Export All Data</button>
            <button onclick="dataExportManager.createBackup()">üíæ Create Backup</button>
            <button onclick="dataExportManager.importData()">üì• Import Data</button>
            <button onclick="dataExportManager.scheduleAutoBackup()">‚è∞ Auto Backup</button>
          </div>
        </div>

        <output id="exportOut" class="result"></output>
      </section>

      <!-- User Feedback & Analytics -->
      <section class="calculator" id="feedbackCard">
        <h2>üí¨ Feedback & Analytics</h2>
        
        <div class="input-group">
          <p class="helper-text">Share feedback, track usage analytics, and help improve the training system through smart data collection.</p>
        </div>

        <div class="feedback-controls">
          <button onclick="userFeedbackManager.initializeFeedbackSystem()">üéØ Initialize Feedback</button>
          <button onclick="userFeedbackManager.showFeedbackForm()">üí≠ Submit Feedback</button>
          <button onclick="userFeedbackManager.viewAnalytics()">üìä View Analytics</button>
          <button onclick="userFeedbackManager.exportFeedbackData()">üì§ Export Feedback</button>
        </div>

        <!-- Feedback Stats -->
        <div class="feedback-stats" id="feedbackStats" style="display: none;">
          <h4>üìà Feedback Analytics</h4>
          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-value" id="totalFeedback">0</div>
              <div class="stat-label">Total Feedback</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="avgRating">-</div>
              <div class="stat-label">Avg Rating</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="sessionsTracked">0</div>
              <div class="stat-label">Sessions</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="improvementScore">-</div>
              <div class="stat-label">Improvement</div>
            </div>
          </div>
        </div>

        <output id="feedbackOut" class="result"></output>
      </section>

    </div>
  </div>
</div>

<!-- Load modules and initialize -->
<script>
// Initialize collapsible sections
function initializeCollapsibleSections() {
  // Set up initial icon states
  const sections = ['daily', 'weekly', 'setup', 'advanced'];
  
  sections.forEach(sectionId => {
    const content = document.getElementById(sectionId + '-content');
    const banner = content.previousElementSibling;
    const icon = banner.querySelector('.expand-icon');
    
    if (content.classList.contains('expanded')) {
      banner.classList.add('expanded');
      icon.style.transform = 'rotate(180deg)';
    } else {
      banner.classList.remove('expanded');
      icon.style.transform = 'rotate(0deg)';
    }
  });
}

// Dismiss quick-start guide
function dismissQuickStart() {
  const guide = document.getElementById('quickStartGuide');
  const dontShowCheckbox = document.getElementById('dontShowQuickStart');
  
  if (guide) {
    guide.classList.add('hidden');
  }
  
  // Save preference if checkbox is checked
  if (dontShowCheckbox && dontShowCheckbox.checked) {
    localStorage.setItem('rpQuickStartDismissed', 'true');
  }
}

// Initialize quick-start guide visibility
function initQuickStartGuide() {
  const guide = document.getElementById('quickStartGuide');
  const isDismissed = localStorage.getItem('rpQuickStartDismissed') === 'true';
  
  if (guide && isDismissed) {
    guide.classList.add('hidden');
  }
}

// Override any conflicting toggleSection functions that may be loaded
window.toggleSection = function(sectionId) {
  const content = document.getElementById(sectionId + '-content');
  const banner = content.previousElementSibling;
  const icon = banner.querySelector('.expand-icon');

  const opening = !content.classList.contains('expanded');

  // ------- EXPAND -------
  if (opening) {
    content.style.display = 'block';           // back in flow
    // allow next paint, then add class so CSS transition plays
    requestAnimationFrame(() => {
      content.classList.add('expanded');
      banner.classList.add('expanded');
      // Update icon rotation
      if (icon) {
        icon.style.transform = 'rotate(180deg)';
      }
    });
  }

  // ------- COLLAPSE -------
  else {
    content.classList.remove('expanded');      // start transition
    banner.classList.remove('expanded');
    // Update icon rotation
    if (icon) {
      icon.style.transform = 'rotate(0deg)';
    }

    // when transition ends hide element to drop layout height
    content.addEventListener('transitionend', function handler() {
      content.style.display = 'none';
      content.removeEventListener('transitionend', handler);
    });
  }
};

// Initialize sections immediately when DOM loads
document.addEventListener('DOMContentLoaded', function() {
  initializeCollapsibleSections();
  initQuickStartGuide();
});
</script>

<script type="module">
import trainingState from './js/core/trainingState.js';
import { initChart, updateChart, addVolumeLandmarks, resetChart, exportChartImage } from './js/ui/chartManager.js';
import { initVolumeCard, updateVolumeDisplays } from './js/ui/volumeCardUI.js';
import { initFeedbackForm } from './js/ui/feedbackFormUI.js';
import { 
  scoreStimulus, 
  setProgressionAlgorithm, 
  getVolumeProgression,
  analyzeDeloadNeed 
} from './js/algorithms/volume.js';
import { calculateTargetRIR, validateEffortLevel } from './js/algorithms/effort.js';
import { analyzeFrequency, calculateOptimalFrequency } from './js/algorithms/fatigue.js';
import { validateLoad, validateSets, validateMesocycleLength } from './js/algorithms/validation.js';

// Make key functions global for button handlers
window.trainingState = trainingState;
window.updateChart = updateChart;
window.resetWeeklyData = resetChart;
window.showVolumeLandmarks = addVolumeLandmarks;

// Initialize UI
document.addEventListener('DOMContentLoaded', function() {
  initializeTrainingState();
  initChart();
  initVolumeCard();
  initFeedbackForm();
  updateAllDisplays();
  
  // Migrate legacy data
  trainingState.migrateLegacyData();
  
  console.log('RP Toolkit initialized');
});

// Initialize training state display
function initializeTrainingState() {
  const summary = trainingState.getStateSummary();
  
  document.getElementById('currentWeek').textContent = summary.week;
  document.getElementById('currentMeso').textContent = summary.meso;
  document.getElementById('currentBlock').textContent = summary.block;
  document.getElementById('targetRIR').textContent = summary.targetRIR.toFixed(1);
  document.getElementById('currentPhase').textContent = summary.currentPhase;
  document.getElementById('targetRIRDisplay').textContent = summary.targetRIR.toFixed(1);
}

// Update all displays
function updateAllDisplays() {
  updateVolumeDisplays();
  updateChart();
  initializeTrainingState();
}

// Update landmark displays when muscle changes (for landmark editing section)
document.addEventListener('change', function(e) {
  if (e.target.id === 'landmarkMuscle') {
    const muscle = e.target.value;
    const landmarks = trainingState.volumeLandmarks[muscle];
    
    document.getElementById('mv').value = landmarks.MV;
    document.getElementById('mev').value = landmarks.MEV;
    document.getElementById('mav').value = landmarks.MAV;
    document.getElementById('mrv').value = landmarks.MRV;
  }
  
  // Note: muscleSelect dropdown is handled by volumeCardUI.js
});

// Note: Auto-save on volume changes is handled by volumeCardUI.js

</script>

<!-- Login Modal -->
<div id="authModal" class="modal hidden">
  <div class="modal-content">
    <h2>Login / Sign-up</h2>    <form id="authForm" onsubmit="event.preventDefault(); handleSignIn();">
      <input id="authEmail" type="email" placeholder="Email" autocomplete="email">
      <input id="authPass" type="password" placeholder="Password" autocomplete="current-password">
      <button type="submit" id="btnLogin">LOGIN</button>
      <button type="button" id="btnSignUp" onclick="handleSignUp()">SIGN UP</button>
    </form>
  </div>
</div>
<style>
#authModal{
  position:fixed;
  inset:0;
  background:#000a;        /* semi-transparent backdrop */
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:10000;           /* keep it above everything */
}

#authModal.hidden{display:none;}

.modal-content{background:#222;padding:2rem;border-radius:8px;width:300px}

#authForm {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

#authForm input, #authForm button {
  margin-bottom: 10px;
}
.modal-content input, .modal-content button{width:100%;margin:6px 0;padding:8px}
</style>

<!-- Initialize auth modal on page load -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Initially show the auth modal until we know user is authenticated
  document.getElementById('authModal').classList.remove('hidden');
  // Auth state will be handled by onAuth in globals.js
});
</script>

<!-- then scripts -->
<!-- <script type="module" src="js/ui/enhancedAdvancedUI.js"></script> -->
<!-- <script type="module" src="js/algorithms/dataVisualization.js"></script> -->

<!-- Initialize Enhanced Advanced Features -->
<!-- 
<script type="module">
import { enhancedUI } from './js/ui/enhancedAdvancedUI.js';
import { dataVisualizer } from './js/algorithms/dataVisualization.js';
import { wellnessSystem } from './js/algorithms/wellnessIntegration.js';
import { periodizationSystem } from './js/algorithms/periodizationSystem.js';

// Import utility systems
import { PerformanceManager } from './js/utils/performance.js';
import { DataExportManager } from './js/utils/dataExport.js';
import { UserFeedbackManager } from './js/utils/userFeedback.js';

// Initialize utility managers
const performanceManager = new PerformanceManager();
const dataExportManager = new DataExportManager();
const userFeedbackManager = new UserFeedbackManager();

// Make modules globally available
window.dataVisualizer = dataVisualizer;
window.wellnessSystem = wellnessSystem;
window.periodizationSystem = periodizationSystem;
window.performanceManager = performanceManager;
window.dataExportManager = dataExportManager;
window.userFeedbackManager = userFeedbackManager;

// Initialize enhanced UI on load
document.addEventListener('DOMContentLoaded', () => {
  // Add enhanced dashboard after existing content
  const advancedSection = document.querySelector('#advanced-content');
  if (advancedSection) {
    const enhancedDashboard = enhancedUI.createAdvancedDashboard();
    enhancedDashboard.id = 'enhanced-dashboard';
    enhancedDashboard.style.marginTop = '40px';
    advancedSection.appendChild(enhancedDashboard);
    
    // Initialize enhanced UI
    enhancedUI.initializeEnhancedUI();
    
    // Initialize utility systems
    performanceManager.initialize();
    userFeedbackManager.initializeFeedbackSystem();
    
    console.log('üöÄ Enhanced Advanced Intelligence Features Loaded');
    console.log('‚ö° Performance monitoring initialized');
    console.log('üí¨ User feedback system ready');
    console.log('üíæ Data export system ready');
  }
});
-->
</script>

<!-- Auto-resize: post height every 500 ms -->
<script>
(function () {
  function postHeight () {
    const h = document.documentElement.getBoundingClientRect().height;
    window.parent.postMessage({ phxHeight: h }, '*');
  }
  window.addEventListener('load', postHeight);
  setInterval(postHeight, 500);   // heartbeat
})();
</script>

<script>
// Ensure hideGuide function is directly available
function hideGuide() {
  document.getElementById('quickStartGuide').style.display = 'none';
}
</script>

<script type="module" src="js/ui/globals.js"></script>

</body>
</html>